(async()=>{var Ft=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Br={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function o(c,h,_){this.fn=c,this.context=h,this.once=_||!1}function s(c,h,_,d,v){if(typeof _!="function")throw new TypeError("The listener must be a function");var L=new o(_,d||c,v),$=n?n+h:h;return c._events[$]?c._events[$].fn?c._events[$]=[c._events[$],L]:c._events[$].push(L):(c._events[$]=L,c._eventsCount++),c}function a(c,h){--c._eventsCount===0?c._events=new r:delete c._events[h]}function u(){this._events=new r,this._eventsCount=0}u.prototype.eventNames=function(){var h=[],_,d;if(this._eventsCount===0)return h;for(d in _=this._events)e.call(_,d)&&h.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?h.concat(Object.getOwnPropertySymbols(_)):h},u.prototype.listeners=function(h){var _=n?n+h:h,d=this._events[_];if(!d)return[];if(d.fn)return[d.fn];for(var v=0,L=d.length,$=new Array(L);v<L;v++)$[v]=d[v].fn;return $},u.prototype.listenerCount=function(h){var _=n?n+h:h,d=this._events[_];return d?d.fn?1:d.length:0},u.prototype.emit=function(h,_,d,v,L,$){var H=n?n+h:h;if(!this._events[H])return!1;var j=this._events[H],oe=arguments.length,te,W;if(j.fn){switch(j.once&&this.removeListener(h,j.fn,void 0,!0),oe){case 1:return j.fn.call(j.context),!0;case 2:return j.fn.call(j.context,_),!0;case 3:return j.fn.call(j.context,_,d),!0;case 4:return j.fn.call(j.context,_,d,v),!0;case 5:return j.fn.call(j.context,_,d,v,L),!0;case 6:return j.fn.call(j.context,_,d,v,L,$),!0}for(W=1,te=new Array(oe-1);W<oe;W++)te[W-1]=arguments[W];j.fn.apply(j.context,te)}else{var me=j.length,F;for(W=0;W<me;W++)switch(j[W].once&&this.removeListener(h,j[W].fn,void 0,!0),oe){case 1:j[W].fn.call(j[W].context);break;case 2:j[W].fn.call(j[W].context,_);break;case 3:j[W].fn.call(j[W].context,_,d);break;case 4:j[W].fn.call(j[W].context,_,d,v);break;default:if(!te)for(F=1,te=new Array(oe-1);F<oe;F++)te[F-1]=arguments[F];j[W].fn.apply(j[W].context,te)}}return!0},u.prototype.on=function(h,_,d){return s(this,h,_,d,!1)},u.prototype.once=function(h,_,d){return s(this,h,_,d,!0)},u.prototype.removeListener=function(h,_,d,v){var L=n?n+h:h;if(!this._events[L])return this;if(!_)return a(this,L),this;var $=this._events[L];if($.fn)$.fn===_&&(!v||$.once)&&(!d||$.context===d)&&a(this,L);else{for(var H=0,j=[],oe=$.length;H<oe;H++)($[H].fn!==_||v&&!$[H].once||d&&$[H].context!==d)&&j.push($[H]);j.length?this._events[L]=j.length===1?j[0]:j:a(this,L)}return this},u.prototype.removeAllListeners=function(h){var _;return h?(_=n?n+h:h,this._events[_]&&a(this,_)):(this._events=new r,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=n,u.EventEmitter=u,t.exports=u})(Br);var Ye=Br.exports,Nt,Zi=new Uint8Array(16);function ea(){if(!Nt&&(Nt=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!Nt))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Nt(Zi)}var ta=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function na(t){return typeof t=="string"&&ta.test(t)}var ve=[];for(var _n=0;_n<256;++_n)ve.push((_n+256).toString(16).substr(1));function ra(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=(ve[t[e+0]]+ve[t[e+1]]+ve[t[e+2]]+ve[t[e+3]]+"-"+ve[t[e+4]]+ve[t[e+5]]+"-"+ve[t[e+6]]+ve[t[e+7]]+"-"+ve[t[e+8]]+ve[t[e+9]]+"-"+ve[t[e+10]]+ve[t[e+11]]+ve[t[e+12]]+ve[t[e+13]]+ve[t[e+14]]+ve[t[e+15]]).toLowerCase();if(!na(n))throw TypeError("Stringified UUID is invalid");return n}function oa(t,e,n){t=t||{};var r=t.random||(t.rng||ea)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){n=n||0;for(var o=0;o<16;++o)e[n+o]=r[o];return e}return ra(r)}var Lt,sa=new Uint8Array(16);function ia(){if(!Lt&&(Lt=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!Lt))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Lt(sa)}var aa=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function ca(t){return typeof t=="string"&&aa.test(t)}var Se=[];for(var yn=0;yn<256;++yn)Se.push((yn+256).toString(16).substr(1));function fa(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=(Se[t[e+0]]+Se[t[e+1]]+Se[t[e+2]]+Se[t[e+3]]+"-"+Se[t[e+4]]+Se[t[e+5]]+"-"+Se[t[e+6]]+Se[t[e+7]]+"-"+Se[t[e+8]]+Se[t[e+9]]+"-"+Se[t[e+10]]+Se[t[e+11]]+Se[t[e+12]]+Se[t[e+13]]+Se[t[e+14]]+Se[t[e+15]]).toLowerCase();if(!ca(n))throw TypeError("Stringified UUID is invalid");return n}function ua(t,e,n){t=t||{};var r=t.random||(t.rng||ia)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){n=n||0;for(var o=0;o<16;++o)e[n+o]=r[o];return e}return fa(r)}function zr(){return ua().replace(/-/g,"")}let $n=zr;const Bn=()=>$n();Bn.setFactory=t=>{$n=t};Bn.reset=()=>{$n=zr};const Ze=Symbol.for("_am_meta"),xt=Symbol.for("_am_heads"),ut=Symbol.for("_am_trace"),Ke=Symbol.for("_am_objectId"),nn=Symbol.for("_am_readOnly"),Et=Symbol.for("_am_frozen"),Vr=Symbol.for("_am_uint"),Wr=Symbol.for("_am_int"),Hr=Symbol.for("_am_f64"),Kr=Symbol.for("_am_counter"),Yr=Symbol.for("_am_text");class lt{constructor(e){this.value=e||0,Reflect.defineProperty(this,Kr,{value:!0})}valueOf(){return this.value}toString(){return this.valueOf().toString()}toJSON(){return this.value}}class la extends lt{constructor(e,n,r,o,s){super(e),this.context=n,this.path=r,this.objectId=o,this.key=s}increment(e){return e=typeof e=="number"?e:1,this.context.increment(this.objectId,this.key,e),this.value+=e,this.value}decrement(e){return this.increment(typeof e=="number"?-e:-1)}}function da(t,e,n,r,o){return new la(t,e,n,r,o)}class et{constructor(e){if(typeof e=="string")this.elems=[...e];else if(Array.isArray(e))this.elems=e;else if(e===void 0)this.elems=[];else throw new TypeError(`Unsupported initial value for Text: ${e}`);Reflect.defineProperty(this,Yr,{value:!0})}get length(){return this.elems.length}get(e){return this.elems[e]}[Symbol.iterator](){const e=this.elems;let n=-1;return{next(){return n+=1,n<e.length?{done:!1,value:e[n]}:{done:!0}}}}toString(){if(!this.str){this.str="";for(const e of this.elems)typeof e=="string"?this.str+=e:this.str+="￼"}return this.str}toSpans(){if(!this.spans){this.spans=[];let e="";for(const n of this.elems)typeof n=="string"?e+=n:(e.length>0&&(this.spans.push(e),e=""),this.spans.push(n));e.length>0&&this.spans.push(e)}return this.spans}toJSON(){return this.toString()}set(e,n){if(this[Ze])throw new RangeError("object cannot be modified outside of a change block");this.elems[e]=n}insertAt(e,...n){if(this[Ze])throw new RangeError("object cannot be modified outside of a change block");this.elems.splice(e,0,...n)}deleteAt(e,n=1){if(this[Ze])throw new RangeError("object cannot be modified outside of a change block");this.elems.splice(e,n)}map(e){this.elems.map(e)}lastIndexOf(e,n){this.elems.lastIndexOf(e,n)}concat(e){return new et(this.elems.concat(e.elems))}every(e){return this.elems.every(e)}filter(e){return new et(this.elems.filter(e))}find(e){return this.elems.find(e)}findIndex(e){return this.elems.findIndex(e)}forEach(e){this.elems.forEach(e)}includes(e){return this.elems.includes(e)}indexOf(e){return this.elems.indexOf(e)}join(e){return this.elems.join(e)}reduce(e){this.elems.reduce(e)}reduceRight(e){this.elems.reduceRight(e)}slice(e,n){new et(this.elems.slice(e,n))}some(e){return this.elems.some(e)}toLocaleString(){this.toString()}}function He(t){if(typeof t=="string"&&/^[0-9]+$/.test(t)&&(t=parseInt(t,10)),typeof t!="number")return t;if(t<0||isNaN(t)||t===1/0||t===-1/0)throw new RangeError("A list index must be positive, but you passed "+t);return t}function De(t,e){const{context:n,objectId:r,path:o,readonly:s,heads:a}=t,u=n.getWithType(r,e,a);if(u===null)return;const c=u[0],h=u[1];switch(c){case void 0:return;case"map":return dt(n,h,[...o,e],s,a);case"list":return Rt(n,h,[...o,e],s,a);case"text":return Ot(n,h,[...o,e],s,a);case"str":return h;case"uint":return h;case"int":return h;case"f64":return h;case"boolean":return h;case"null":return null;case"bytes":return h;case"timestamp":return h;case"counter":return s?new lt(h):da(h,n,o,r,e);default:throw RangeError(`datatype ${c} unimplemented`)}}function Xt(t){switch(typeof t){case"object":if(t==null)return[null,"null"];if(t[Vr])return[t.value,"uint"];if(t[Wr])return[t.value,"int"];if(t[Hr])return[t.value,"f64"];if(t[Kr])return[t.value,"counter"];if(t[Yr])return[t,"text"];if(t instanceof Date)return[t.getTime(),"timestamp"];if(t instanceof Uint8Array)return[t,"bytes"];if(t instanceof Array)return[t,"list"];if(Object.getPrototypeOf(t)===Object.getPrototypeOf({}))return[t,"map"];throw t[Ke]?new RangeError("Cannot create a reference to an existing document object"):new RangeError(`Cannot assign unknown object: ${t}`);case"boolean":return[t,"boolean"];case"number":return Number.isInteger(t)?[t,"int"]:[t,"f64"];case"string":return[t];default:throw new RangeError(`Unsupported type of value: ${typeof t}`)}}const ha={get(t,e){const{context:n,objectId:r,readonly:o,frozen:s,heads:a,cache:u}=t;return e===Symbol.toStringTag?t[Symbol.toStringTag]:e===Ke?r:e===nn?o:e===Et?s:e===xt?a:e===ut?t.trace:e===Ze?n:(u[e]||(u[e]=De(t,e)),u[e])},set(t,e,n){const{context:r,objectId:o,path:s,readonly:a,frozen:u}=t;if(t.cache={},n&&n[Ke])throw new RangeError("Cannot create a reference to an existing document object");if(e===Et)return t.frozen=n,!0;if(e===xt)return t.heads=n,!0;if(e===ut)return t.trace=n,!0;const[c,h]=Xt(n);if(u)throw new RangeError("Attempting to use an outdated Automerge document");if(a)throw new RangeError(`Object property "${e}" cannot be modified`);switch(h){case"list":{const _=r.putObject(o,e,[]),d=Rt(r,_,[...s,e],a);for(let v=0;v<c.length;v++)d[v]=c[v];break}case"text":{const _=r.putObject(o,e,"","text"),d=Ot(r,_,[...s,e],a);for(let v=0;v<c.length;v++)d[v]=c.get(v);break}case"map":{const _=r.putObject(o,e,{}),d=dt(r,_,[...s,e],a);for(const v in c)d[v]=c[v];break}default:r.put(o,e,c,h)}return!0},deleteProperty(t,e){const{context:n,objectId:r,readonly:o}=t;if(t.cache={},o)throw new RangeError(`Object property "${e}" cannot be modified`);return n.delete(r,e),!0},has(t,e){return this.get(t,e)!==void 0},getOwnPropertyDescriptor(t,e){const n=this.get(t,e);if(typeof n<"u")return{configurable:!0,enumerable:!0,value:n}},ownKeys(t){const{context:e,objectId:n,heads:r}=t,o=e.keys(n,r);return[...new Set(o)]}},Jr={get(t,e){const{context:n,objectId:r,readonly:o,frozen:s,heads:a}=t;return e=He(e),e===Symbol.hasInstance?u=>Array.isArray(u):e===Symbol.toStringTag?t[Symbol.toStringTag]:e===Ke?r:e===nn?o:e===Et?s:e===xt?a:e===ut?t.trace:e===Ze?n:e==="length"?n.length(r,a):typeof e=="number"?De(t,e):qr(t)[e]},set(t,e,n){const{context:r,objectId:o,path:s,readonly:a,frozen:u}=t;if(e=He(e),n&&n[Ke])throw new RangeError("Cannot create a reference to an existing document object");if(e===Et)return t.frozen=n,!0;if(e===xt)return t.heads=n,!0;if(e===ut)return t.trace=n,!0;if(typeof e=="string")throw new RangeError("list index must be a number");const[c,h]=Xt(n);if(u)throw new RangeError("Attempting to use an outdated Automerge document");if(a)throw new RangeError(`Object property "${e}" cannot be modified`);switch(h){case"list":{let _;e>=r.length(o)?_=r.insertObject(o,e,[]):_=r.putObject(o,e,[]),Rt(r,_,[...s,e],a).splice(0,0,...c);break}case"text":{let _;e>=r.length(o)?_=r.insertObject(o,e,"","text"):_=r.putObject(o,e,"","text"),Ot(r,_,[...s,e],a).splice(0,0,...c);break}case"map":{let _;e>=r.length(o)?_=r.insertObject(o,e,{}):_=r.putObject(o,e,{});const d=dt(r,_,[...s,e],a);for(const v in c)d[v]=c[v];break}default:e>=r.length(o)?r.insert(o,e,c,h):r.put(o,e,c,h)}return!0},deleteProperty(t,e){const{context:n,objectId:r}=t;if(e=He(e),n.get(r,e)[0]=="counter")throw new TypeError("Unsupported operation: deleting a counter from a list");return n.delete(r,e),!0},has(t,e){const{context:n,objectId:r,heads:o}=t;return e=He(e),typeof e=="number"?e<n.length(r,o):e==="length"},getOwnPropertyDescriptor(t,e){const{context:n,objectId:r,heads:o}=t;return e==="length"?{writable:!0,value:n.length(r,o)}:e===Ke?{configurable:!1,enumerable:!1,value:r}:(e=He(e),{configurable:!0,enumerable:!0,value:De(t,e)})},getPrototypeOf(t){return Object.getPrototypeOf(t)},ownKeys(){const t=[];return t.push("length"),t}},ga=Object.assign({},Jr,{get(t,e){const{context:n,objectId:r,readonly:o,frozen:s,heads:a}=t;return e=He(e),e===Symbol.toStringTag?t[Symbol.toStringTag]:e===Symbol.hasInstance?u=>Array.isArray(u):e===Ke?r:e===nn?o:e===Et?s:e===xt?a:e===ut?t.trace:e===Ze?n:e==="length"?n.length(r,a):typeof e=="number"?De(t,e):ya(t)[e]||qr(t)[e]},getPrototypeOf(){return Object.getPrototypeOf(new et)}});function dt(t,e,n,r,o){return new Proxy({context:t,objectId:e,path:n,readonly:!!r,frozen:!1,heads:o,cache:{}},ha)}function Rt(t,e,n,r,o){const s=[];return Object.assign(s,{context:t,objectId:e,path:n,readonly:!!r,frozen:!1,heads:o,cache:{}}),new Proxy(s,Jr)}function Ot(t,e,n,r,o){const s=[];return Object.assign(s,{context:t,objectId:e,path:n,readonly:!!r,frozen:!1,heads:o,cache:{}}),new Proxy(s,ga)}function _a(t,e){return dt(t,"_root",[],!!e)}function qr(t){const{context:e,objectId:n,path:r,readonly:o,frozen:s,heads:a}=t;return{deleteAt(c,h){return typeof h=="number"?e.splice(n,c,h):e.delete(n,c),this},fill(c,h,_){const[d,v]=Xt(c),L=e.length(n);h=He(h||0),_=He(_||L);for(let $=h;$<Math.min(_,L);$++)e.put(n,$,d,v);return this},indexOf(c,h=0){const _=e.length(n);for(let d=h;d<_;d++){const v=e.getWithType(n,d,a);if(v&&v[1]===c[Ke]||v[1]===c)return d}return-1},insertAt(c,...h){return this.splice(c,0,...h),this},pop(){const c=e.length(n);if(c==0)return;const h=De(t,c-1);return e.delete(n,c-1),h},push(...c){const h=e.length(n);return this.splice(h,0,...c),e.length(n)},shift(){if(e.length(n)==0)return;const c=De(t,0);return e.delete(n,0),c},splice(c,h,..._){c=He(c),h=He(h);for(const L of _)if(L&&L[Ke])throw new RangeError("Cannot create a reference to an existing document object");if(s)throw new RangeError("Attempting to use an outdated Automerge document");if(o)throw new RangeError("Sequence object cannot be modified outside of a change block");const d=[];for(let L=0;L<h;L++){const $=De(t,c);$!==void 0&&d.push($),e.delete(n,c)}const v=_.map(L=>Xt(L));for(const[L,$]of v){switch($){case"list":{const H=e.insertObject(n,c,[]);Rt(e,H,[...r,c],o).splice(0,0,...L);break}case"text":{const H=e.insertObject(n,c,"","text");Ot(e,H,[...r,c],o).splice(0,0,...L);break}case"map":{const H=e.insertObject(n,c,{}),j=dt(e,H,[...r,c],o);for(const oe in L)j[oe]=L[oe];break}default:e.insert(n,c,L,$)}c+=1}return d},unshift(...c){return this.splice(0,0,...c),e.length(n)},entries(){return{next:()=>{const _=De(t,0);return _===void 0?{value:void 0,done:!0}:{value:[0,_],done:!1}}}},keys(){let c=0;const h=e.length(n,a);return{next:()=>{let d;return c<h&&(d=c,c++),{value:d,done:!0}}}},values(){return{next:()=>{const _=De(t,0);return _===void 0?{value:void 0,done:!0}:{value:_,done:!1}}}},toArray(){const c=[];let h;do h=De(t,c.length),h!==void 0&&c.push(h);while(h!==void 0);return c},map(c){return this.toArray().map(c)},toString(){return this.toArray().toString()},toLocaleString(){return this.toArray().toLocaleString()},forEach(c){return this.toArray().forEach(c)},concat(c){return this.toArray().concat(c)},every(c){return this.toArray().every(c)},filter(c){return this.toArray().filter(c)},find(c){let h=0;for(let _ of this){if(c(_,h))return _;h+=1}},findIndex(c){let h=0;for(let _ of this){if(c(_,h))return h;h+=1}return-1},includes(c){return this.find(h=>h===c)!==void 0},join(c){return this.toArray().join(c)},reduce(c,h){return this.toArray().reduce(c,h)},reduceRight(c,h){return this.toArray().reduceRight(c,h)},lastIndexOf(c,h=1/0){return this.toArray().lastIndexOf(c,h)},slice(c,h){return this.toArray().slice(c,h)},some(c){let h=0;for(let _ of this){if(c(_,h))return!0;h+=1}return!1},[Symbol.iterator]:function*(){let c=0,h=De(t,c);for(;h!==void 0;)yield h,c+=1,h=De(t,c)}}}function ya(t){const{context:e,objectId:n,heads:r}=t;return{set(s,a){return this[s]=a},get(s){return this[s]},toString(){return e.text(n,r).replace(/￼/g,"")},toSpans(){const s=[];let a="";const u=e.length(n);for(let c=0;c<u;c++){const h=this[c];typeof h=="string"?a+=h:(a.length>0&&(s.push(a),a=""),s.push(h))}return a.length>0&&s.push(a),s},toJSON(){return this.toString()},indexOf(s,a=0){return e.text(n).indexOf(s,a)}}}class ba{constructor(e){if(!(Number.isInteger(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER))throw new RangeError(`Value ${e} cannot be a uint`);this.value=e,Reflect.defineProperty(this,Wr,{value:!0}),Object.freeze(this)}}class pa{constructor(e){if(!(Number.isInteger(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=0))throw new RangeError(`Value ${e} cannot be a uint`);this.value=e,Reflect.defineProperty(this,Vr,{value:!0}),Object.freeze(this)}}class ma{constructor(e){if(typeof e!="number")throw new RangeError(`Value ${e} cannot be a float64`);this.value=e||0,Reflect.defineProperty(this,Hr,{value:!0}),Object.freeze(this)}}function wa(t){for(const e in t)xe[e]=t[e]}const xe={create(t){throw new RangeError("Automerge.use() not called")},load(t,e){throw new RangeError("Automerge.use() not called (load)")},encodeChange(t){throw new RangeError("Automerge.use() not called (encodeChange)")},decodeChange(t){throw new RangeError("Automerge.use() not called (decodeChange)")},initSyncState(){throw new RangeError("Automerge.use() not called (initSyncState)")},encodeSyncMessage(t){throw new RangeError("Automerge.use() not called (encodeSyncMessage)")},decodeSyncMessage(t){throw new RangeError("Automerge.use() not called (decodeSyncMessage)")},encodeSyncState(t){throw new RangeError("Automerge.use() not called (encodeSyncState)")},decodeSyncState(t){throw new RangeError("Automerge.use() not called (decodeSyncState)")},exportSyncState(t){throw new RangeError("Automerge.use() not called (exportSyncState)")},importSyncState(t){throw new RangeError("Automerge.use() not called (importSyncState)")}};var va="/blutack/assets/automerge_wasm_bg.f6f8661d.wasm",Sa=async(t={},e)=>{let n;if(e.startsWith("data:")){const r=e.replace(/^data:.*?base64,/,"");let o;if(typeof Buffer=="function"&&typeof Buffer.from=="function")o=Buffer.from(r,"base64");else if(typeof atob=="function"){const s=atob(r);o=new Uint8Array(s.length);for(let a=0;a<s.length;a++)o[a]=s.charCodeAt(a)}else throw new Error("Cannot decode base64-encoded data URL");n=await WebAssembly.instantiate(o,t)}else{const r=await fetch(e),o=r.headers.get("Content-Type")||"";if("instantiateStreaming"in WebAssembly&&o.startsWith("application/wasm"))n=await WebAssembly.instantiateStreaming(r,t);else{const s=await r.arrayBuffer();n=await WebAssembly.instantiate(s,t)}}return n.instance.exports};const qe=new Array(32).fill(void 0);qe.push(void 0,null,!0,!1);function D(t){return qe[t]}let vt=qe.length;function xa(t){t<36||(qe[t]=vt,vt=t)}function N(t){const e=D(t);return xa(t),e}const Ea=typeof TextDecoder>"u"?(0,module.require)("util").TextDecoder:TextDecoder;let Gr=new Ea("utf-8",{ignoreBOM:!0,fatal:!0});Gr.decode();let bn=new Uint8Array;function St(){return bn.byteLength===0&&(bn=new Uint8Array(rn.buffer)),bn}function Pe(t,e){return Gr.decode(St().subarray(t,t+e))}function C(t){vt===qe.length&&qe.push(qe.length+1);const e=vt;return vt=qe[e],qe[e]=t,e}function be(t){return t==null}let pn=new Float64Array;function Rn(){return pn.byteLength===0&&(pn=new Float64Array(rn.buffer)),pn}let mn=new Int32Array;function S(){return mn.byteLength===0&&(mn=new Int32Array(rn.buffer)),mn}let Me=0;const Ca=typeof TextEncoder>"u"?(0,module.require)("util").TextEncoder:TextEncoder;let Ht=new Ca("utf-8");const Aa=typeof Ht.encodeInto=="function"?function(t,e){return Ht.encodeInto(t,e)}:function(t,e){const n=Ht.encode(t);return e.set(n),{read:t.length,written:n.length}};function Fe(t,e,n){if(n===void 0){const u=Ht.encode(t),c=e(u.length);return St().subarray(c,c+u.length).set(u),Me=u.length,c}let r=t.length,o=e(r);const s=St();let a=0;for(;a<r;a++){const u=t.charCodeAt(a);if(u>127)break;s[o+a]=u}if(a!==r){a!==0&&(t=t.slice(a)),o=n(o,r,r=a+t.length*3);const u=St().subarray(o+a,o+r),c=Aa(t,u);a+=c.written}return Me=a,o}function On(t){const e=typeof t;if(e=="number"||e=="boolean"||t==null)return`${t}`;if(e=="string")return`"${t}"`;if(e=="symbol"){const o=t.description;return o==null?"Symbol":`Symbol(${o})`}if(e=="function"){const o=t.name;return typeof o=="string"&&o.length>0?`Function(${o})`:"Function"}if(Array.isArray(t)){const o=t.length;let s="[";o>0&&(s+=On(t[0]));for(let a=1;a<o;a++)s+=", "+On(t[a]);return s+="]",s}const n=/\[object ([^\]]+)\]/.exec(toString.call(t));let r;if(n.length>1)r=n[1];else return toString.call(t);if(r=="Object")try{return"Object("+JSON.stringify(t)+")"}catch{return"Object"}return t instanceof Error?`${t.name}: ${t.message}
${t.stack}`:r}function ft(t,e){if(!(t instanceof e))throw new Error(`expected instance of ${e.name}`);return t.ptr}function Ia(t){try{const a=O(-16);var e=be(t)?0:Fe(t,Ne,Le),n=Me;Rc(a,e,n);var r=S()[a/4+0],o=S()[a/4+1],s=S()[a/4+2];if(s)throw N(o);return We.__wrap(r)}finally{O(16)}}function Ra(t,e){try{const u=O(-16);var n=be(e)?0:Fe(e,Ne,Le),r=Me;Oc(u,C(t),n,r);var o=S()[u/4+0],s=S()[u/4+1],a=S()[u/4+2];if(a)throw N(s);return We.__wrap(o)}finally{O(16)}}function Oa(t){try{const o=O(-16);kc(o,C(t));var e=S()[o/4+0],n=S()[o/4+1],r=S()[o/4+2];if(r)throw N(n);return N(e)}finally{O(16)}}function ka(t){try{const o=O(-16);Mc(o,C(t));var e=S()[o/4+0],n=S()[o/4+1],r=S()[o/4+2];if(r)throw N(n);return N(e)}finally{O(16)}}function Ma(){const t=Tc();return $e.__wrap(t)}function Ta(t){try{const o=O(-16);Dc(o,C(t));var e=S()[o/4+0],n=S()[o/4+1],r=S()[o/4+2];if(r)throw N(n);return $e.__wrap(e)}finally{O(16)}}function Da(t){ft(t,$e);const e=jc(t.ptr);return N(e)}function ja(t){try{const o=O(-16);Pc(o,C(t));var e=S()[o/4+0],n=S()[o/4+1],r=S()[o/4+2];if(r)throw N(n);return N(e)}finally{O(16)}}function Pa(t){try{const o=O(-16);Fc(o,C(t));var e=S()[o/4+0],n=S()[o/4+1],r=S()[o/4+2];if(r)throw N(n);return N(e)}finally{O(16)}}function Fa(t){try{const o=O(-16);ft(t,$e),Nc(o,t.ptr);var e=S()[o/4+0],n=S()[o/4+1],r=S()[o/4+2];if(r)throw N(n);return N(e)}finally{O(16)}}function Na(t){try{const o=O(-16);Lc(o,C(t));var e=S()[o/4+0],n=S()[o/4+1],r=S()[o/4+2];if(r)throw N(n);return $e.__wrap(e)}finally{O(16)}}function Ee(t,e){try{return t.apply(this,e)}catch(n){Wc(C(n))}}function La(t,e){return St().subarray(t/1,t/1+e)}const pr=new FinalizationRegistry(t=>Is(t));class We{static __wrap(e){const n=Object.create(We.prototype);return n.ptr=e,pr.register(n,n.ptr,n),n}__destroy_into_raw(){const e=this.ptr;return this.ptr=0,pr.unregister(this),e}free(){const e=this.__destroy_into_raw();Is(e)}static new(e){try{const u=O(-16);var n=be(e)?0:Fe(e,Ne,Le),r=Me;Ua(u,n,r);var o=S()[u/4+0],s=S()[u/4+1],a=S()[u/4+2];if(a)throw N(s);return We.__wrap(o)}finally{O(16)}}clone(e){try{const u=O(-16);var n=be(e)?0:Fe(e,Ne,Le),r=Me;$a(u,this.ptr,n,r);var o=S()[u/4+0],s=S()[u/4+1],a=S()[u/4+2];if(a)throw N(s);return We.__wrap(o)}finally{O(16)}}fork(e,n){try{const c=O(-16);var r=be(e)?0:Fe(e,Ne,Le),o=Me;Ba(c,this.ptr,r,o,C(n));var s=S()[c/4+0],a=S()[c/4+1],u=S()[c/4+2];if(u)throw N(a);return We.__wrap(s)}finally{O(16)}}pendingOps(){const e=za(this.ptr);return N(e)}commit(e,n){var r=be(e)?0:Fe(e,Ne,Le),o=Me;const s=Va(this.ptr,r,o,!be(n),be(n)?0:n);return N(s)}merge(e){try{const s=O(-16);ft(e,We),Wa(s,this.ptr,e.ptr);var n=S()[s/4+0],r=S()[s/4+1],o=S()[s/4+2];if(o)throw N(r);return N(n)}finally{O(16)}}rollback(){return Ha(this.ptr)}keys(e,n){try{const a=O(-16);Ka(a,this.ptr,C(e),be(n)?0:C(n));var r=S()[a/4+0],o=S()[a/4+1],s=S()[a/4+2];if(s)throw N(o);return N(r)}finally{O(16)}}text(e,n){try{const h=O(-16);Ya(h,this.ptr,C(e),be(n)?0:C(n));var r=S()[h/4+0],o=S()[h/4+1],s=S()[h/4+2],a=S()[h/4+3],u=r,c=o;if(a)throw u=0,c=0,N(s);return Pe(u,c)}finally{O(16),bt(u,c)}}splice(e,n,r,o){try{const u=O(-16);Ja(u,this.ptr,C(e),n,r,C(o));var s=S()[u/4+0],a=S()[u/4+1];if(a)throw N(s)}finally{O(16)}}push(e,n,r){try{const a=O(-16);qa(a,this.ptr,C(e),C(n),C(r));var o=S()[a/4+0],s=S()[a/4+1];if(s)throw N(o)}finally{O(16)}}pushObject(e,n){try{const u=O(-16);Ga(u,this.ptr,C(e),C(n));var r=S()[u/4+0],o=S()[u/4+1],s=S()[u/4+2],a=S()[u/4+3];if(a)throw N(s);let c;return r!==0&&(c=Pe(r,o).slice(),bt(r,o*1)),c}finally{O(16)}}insert(e,n,r,o){try{const u=O(-16);Xa(u,this.ptr,C(e),n,C(r),C(o));var s=S()[u/4+0],a=S()[u/4+1];if(a)throw N(s)}finally{O(16)}}insertObject(e,n,r){try{const c=O(-16);Qa(c,this.ptr,C(e),n,C(r));var o=S()[c/4+0],s=S()[c/4+1],a=S()[c/4+2],u=S()[c/4+3];if(u)throw N(a);let h;return o!==0&&(h=Pe(o,s).slice(),bt(o,s*1)),h}finally{O(16)}}put(e,n,r,o){try{const u=O(-16);Za(u,this.ptr,C(e),C(n),C(r),C(o));var s=S()[u/4+0],a=S()[u/4+1];if(a)throw N(s)}finally{O(16)}}putObject(e,n,r){try{const u=O(-16);ec(u,this.ptr,C(e),C(n),C(r));var o=S()[u/4+0],s=S()[u/4+1],a=S()[u/4+2];if(a)throw N(s);return N(o)}finally{O(16)}}increment(e,n,r){try{const a=O(-16);tc(a,this.ptr,C(e),C(n),C(r));var o=S()[a/4+0],s=S()[a/4+1];if(s)throw N(o)}finally{O(16)}}get(e,n,r){try{const u=O(-16);nc(u,this.ptr,C(e),C(n),be(r)?0:C(r));var o=S()[u/4+0],s=S()[u/4+1],a=S()[u/4+2];if(a)throw N(s);return N(o)}finally{O(16)}}getWithType(e,n,r){try{const u=O(-16);rc(u,this.ptr,C(e),C(n),be(r)?0:C(r));var o=S()[u/4+0],s=S()[u/4+1],a=S()[u/4+2];if(a)throw N(s);return N(o)}finally{O(16)}}getAll(e,n,r){try{const u=O(-16);oc(u,this.ptr,C(e),C(n),be(r)?0:C(r));var o=S()[u/4+0],s=S()[u/4+1],a=S()[u/4+2];if(a)throw N(s);return N(o)}finally{O(16)}}enableFreeze(e){try{const s=O(-16);sc(s,this.ptr,C(e));var n=S()[s/4+0],r=S()[s/4+1],o=S()[s/4+2];if(o)throw N(r);return N(n)}finally{O(16)}}enablePatches(e){try{const s=O(-16);ic(s,this.ptr,C(e));var n=S()[s/4+0],r=S()[s/4+1],o=S()[s/4+2];if(o)throw N(r);return N(n)}finally{O(16)}}registerDatatype(e,n){try{const s=O(-16);ac(s,this.ptr,C(e),C(n));var r=S()[s/4+0],o=S()[s/4+1];if(o)throw N(r)}finally{O(16)}}applyPatches(e,n,r){try{const u=O(-16);cc(u,this.ptr,C(e),C(n),C(r));var o=S()[u/4+0],s=S()[u/4+1],a=S()[u/4+2];if(a)throw N(s);return N(o)}finally{O(16)}}popPatches(){try{const o=O(-16);fc(o,this.ptr);var e=S()[o/4+0],n=S()[o/4+1],r=S()[o/4+2];if(r)throw N(n);return N(e)}finally{O(16)}}length(e,n){try{const a=O(-16);uc(a,this.ptr,C(e),be(n)?0:C(n));var r=Rn()[a/8+0],o=S()[a/4+2],s=S()[a/4+3];if(s)throw N(o);return r}finally{O(16)}}delete(e,n){try{const s=O(-16);lc(s,this.ptr,C(e),C(n));var r=S()[s/4+0],o=S()[s/4+1];if(o)throw N(r)}finally{O(16)}}save(){const e=dc(this.ptr);return N(e)}saveIncremental(){const e=hc(this.ptr);return N(e)}loadIncremental(e){try{const s=O(-16);gc(s,this.ptr,C(e));var n=Rn()[s/8+0],r=S()[s/4+2],o=S()[s/4+3];if(o)throw N(r);return n}finally{O(16)}}applyChanges(e){try{const o=O(-16);_c(o,this.ptr,C(e));var n=S()[o/4+0],r=S()[o/4+1];if(r)throw N(n)}finally{O(16)}}getChanges(e){try{const s=O(-16);yc(s,this.ptr,C(e));var n=S()[s/4+0],r=S()[s/4+1],o=S()[s/4+2];if(o)throw N(r);return N(n)}finally{O(16)}}getChangeByHash(e){try{const s=O(-16);bc(s,this.ptr,C(e));var n=S()[s/4+0],r=S()[s/4+1],o=S()[s/4+2];if(o)throw N(r);return N(n)}finally{O(16)}}getChangesAdded(e){try{const s=O(-16);ft(e,We),pc(s,this.ptr,e.ptr);var n=S()[s/4+0],r=S()[s/4+1],o=S()[s/4+2];if(o)throw N(r);return N(n)}finally{O(16)}}getHeads(){const e=mc(this.ptr);return N(e)}getActorId(){try{const r=O(-16);wc(r,this.ptr);var e=S()[r/4+0],n=S()[r/4+1];return Pe(e,n)}finally{O(16),bt(e,n)}}getLastLocalChange(){try{const o=O(-16);vc(o,this.ptr);var e=S()[o/4+0],n=S()[o/4+1],r=S()[o/4+2];if(r)throw N(n);return N(e)}finally{O(16)}}dump(){Sc(this.ptr)}getMissingDeps(e){try{const s=O(-16);xc(s,this.ptr,be(e)?0:C(e));var n=S()[s/4+0],r=S()[s/4+1],o=S()[s/4+2];if(o)throw N(r);return N(n)}finally{O(16)}}receiveSyncMessage(e,n){try{const s=O(-16);ft(e,$e),Ec(s,this.ptr,e.ptr,C(n));var r=S()[s/4+0],o=S()[s/4+1];if(o)throw N(r)}finally{O(16)}}generateSyncMessage(e){try{const s=O(-16);ft(e,$e),Cc(s,this.ptr,e.ptr);var n=S()[s/4+0],r=S()[s/4+1],o=S()[s/4+2];if(o)throw N(r);return N(n)}finally{O(16)}}toJS(e){try{const s=O(-16);Ac(s,this.ptr,C(e));var n=S()[s/4+0],r=S()[s/4+1],o=S()[s/4+2];if(o)throw N(r);return N(n)}finally{O(16)}}materialize(e,n,r){try{const u=O(-16);Ic(u,this.ptr,C(e),be(n)?0:C(n),C(r));var o=S()[u/4+0],s=S()[u/4+1],a=S()[u/4+2];if(a)throw N(s);return N(o)}finally{O(16)}}}const mr=new FinalizationRegistry(t=>Rs(t));class $e{static __wrap(e){const n=Object.create($e.prototype);return n.ptr=e,mr.register(n,n.ptr,n),n}__destroy_into_raw(){const e=this.ptr;return this.ptr=0,mr.unregister(this),e}free(){const e=this.__destroy_into_raw();Rs(e)}get sharedHeads(){const e=Uc(this.ptr);return N(e)}get lastSentHeads(){const e=$c(this.ptr);return N(e)}set lastSentHeads(e){try{const o=O(-16);Bc(o,this.ptr,C(e));var n=S()[o/4+0],r=S()[o/4+1];if(r)throw N(n)}finally{O(16)}}set sentHashes(e){try{const o=O(-16);zc(o,this.ptr,C(e));var n=S()[o/4+0],r=S()[o/4+1];if(r)throw N(n)}finally{O(16)}}clone(){const e=Vc(this.ptr);return $e.__wrap(e)}}function Xr(t){N(t)}function Qr(t,e){const n=Pe(t,e);return C(n)}function Zr(t){return D(t)===void 0}function eo(t){const e=D(t);return C(e)}function to(t,e){const n=D(e),r=typeof n=="number"?n:void 0;Rn()[t/8+1]=be(r)?0:r,S()[t/4+0]=!be(r)}function no(t){return C(t)}function ro(t){return typeof D(t)=="function"}function oo(t,e){const n=D(e),r=typeof n=="string"?n:void 0;var o=be(r)?0:Fe(r,Ne,Le),s=Me;S()[t/4+1]=s,S()[t/4+0]=o}function so(t){const e=D(t);return typeof e=="boolean"?e?1:0:2}function io(t){return D(t)===null}function ao(t,e){const n=D(e),r=JSON.stringify(n===void 0?null:n),o=Fe(r,Ne,Le),s=Me;S()[t/4+1]=s,S()[t/4+0]=o}function co(t,e){const n=new Error(Pe(t,e));return C(n)}function fo(){const t=new Error;return C(t)}function uo(t,e){const n=D(e).stack,r=Fe(n,Ne,Le),o=Me;S()[t/4+1]=o,S()[t/4+0]=r}function lo(t,e){try{console.error(Pe(t,e))}finally{bt(t,e)}}function ho(t){return C(t)}function go(t){const e=BigInt.asUintN(64,t);return C(e)}function _o(t){const e=D(t);return typeof e=="object"&&e!==null}function yo(t,e){return D(t)==D(e)}function bo(t,e){const n=String(D(e)),r=Fe(n,Ne,Le),o=Me;S()[t/4+1]=o,S()[t/4+0]=r}function po(t,e,n){D(t)[N(e)]=N(n)}function mo(t){const e=D(t).crypto;return C(e)}function wo(t){const e=D(t).process;return C(e)}function vo(t){const e=D(t).versions;return C(e)}function So(t){const e=D(t).node;return C(e)}function xo(t){return typeof D(t)=="string"}function Eo(t){const e=D(t).msCrypto;return C(e)}function Co(){return Ee(function(){const t=module.require;return C(t)},arguments)}function Ao(){return Ee(function(t,e){D(t).getRandomValues(D(e))},arguments)}function Io(){return Ee(function(t,e,n){D(t).randomFillSync(La(e,n))},arguments)}function Ro(t){console.log(D(t))}function Oo(t,e){console.log(D(t),D(e))}function ko(t,e){const n=D(t)[e>>>0];return C(n)}function Mo(t){return D(t).length}function To(){const t=new Array;return C(t)}function Do(t,e){const n=new Function(Pe(t,e));return C(n)}function jo(t){const e=D(t).next;return C(e)}function Po(){return Ee(function(t){const e=D(t).next();return C(e)},arguments)}function Fo(t){return D(t).done}function No(t){const e=D(t).value;return C(e)}function Lo(){return C(Symbol.iterator)}function Uo(){return Ee(function(t,e){const n=Reflect.get(D(t),D(e));return C(n)},arguments)}function $o(){return Ee(function(t,e){const n=D(t).call(D(e));return C(n)},arguments)}function Bo(){const t=new Object;return C(t)}function zo(){return Ee(function(){const t=self.self;return C(t)},arguments)}function Vo(){return Ee(function(){const t=window.window;return C(t)},arguments)}function Wo(){return Ee(function(){const t=globalThis.globalThis;return C(t)},arguments)}function Ho(){return Ee(function(){const t=global.global;return C(t)},arguments)}function Ko(t,e,n){D(t)[e>>>0]=N(n)}function Yo(t){const e=Array.from(D(t));return C(e)}function Jo(t){return Array.isArray(D(t))}function qo(t,e){return D(t).push(D(e))}function Go(t,e){return D(t).unshift(D(e))}function Xo(t){let e;try{e=D(t) instanceof ArrayBuffer}catch{e=!1}return e}function Qo(t,e){const n=new Error(Pe(t,e));return C(n)}function Zo(){return Ee(function(t,e,n){const r=D(t).call(D(e),D(n));return C(r)},arguments)}function es(){return Ee(function(t,e,n,r,o){const s=D(t).call(D(e),D(n),D(r),D(o));return C(s)},arguments)}function ts(t){let e;try{e=D(t) instanceof Date}catch{e=!1}return e}function ns(t){return D(t).getTime()}function rs(t){const e=new Date(D(t));return C(e)}function os(t){let e;try{e=D(t) instanceof Object}catch{e=!1}return e}function ss(t,e){const n=Object.assign(D(t),D(e));return C(n)}function is(t,e,n){const r=Object.defineProperty(D(t),D(e),D(n));return C(r)}function as(t){const e=Object.entries(D(t));return C(e)}function cs(t){const e=Object.freeze(D(t));return C(e)}function fs(t){const e=Object.keys(D(t));return C(e)}function us(t){const e=Object.values(D(t));return C(e)}function ls(t,e){const n=Symbol.for(Pe(t,e));return C(n)}function ds(t){const e=D(t).buffer;return C(e)}function hs(t,e,n){const r=new Uint8Array(D(t),e>>>0,n>>>0);return C(r)}function gs(t){const e=new Uint8Array(D(t));return C(e)}function _s(t,e,n){D(t).set(D(e),n>>>0)}function ys(t){return D(t).length}function bs(t){let e;try{e=D(t) instanceof Uint8Array}catch{e=!1}return e}function ps(t){const e=new Uint8Array(t>>>0);return C(e)}function ms(t,e,n){const r=D(t).subarray(e>>>0,n>>>0);return C(r)}function ws(){return Ee(function(t,e,n){const r=Reflect.apply(D(t),D(e),D(n));return C(r)},arguments)}function vs(){return Ee(function(t,e){return Reflect.deleteProperty(D(t),D(e))},arguments)}function Ss(){return Ee(function(t){const e=Reflect.ownKeys(D(t));return C(e)},arguments)}function xs(){return Ee(function(t,e,n){return Reflect.set(D(t),D(e),D(n))},arguments)}function Es(t,e){const n=On(D(e)),r=Fe(n,Ne,Le),o=Me;S()[t/4+1]=o,S()[t/4+0]=r}function Cs(t,e){throw new Error(Pe(t,e))}function As(){return C(rn)}const B=await Sa({"./automerge_wasm_bg.js":{__wbindgen_object_drop_ref:Xr,__wbindgen_string_new:Qr,__wbindgen_is_undefined:Zr,__wbindgen_object_clone_ref:eo,__wbindgen_number_get:to,__wbindgen_number_new:no,__wbindgen_is_function:ro,__wbindgen_string_get:oo,__wbindgen_boolean_get:so,__wbindgen_is_null:io,__wbindgen_json_serialize:ao,__wbindgen_error_new:co,__wbg_new_abda76e883ba8a5f:fo,__wbg_stack_658279fe44541cf6:uo,__wbg_error_f851667af71bcfc6:lo,__wbindgen_bigint_from_i64:ho,__wbindgen_bigint_from_u64:go,__wbindgen_is_object:_o,__wbindgen_jsval_loose_eq:yo,__wbg_String_91fba7ded13ba54c:bo,__wbg_set_20cbc34131e76824:po,__wbg_crypto_e1d53a1d73fb10b8:mo,__wbg_process_038c26bf42b093f8:wo,__wbg_versions_ab37218d2f0b24a8:vo,__wbg_node_080f4b19d15bc1fe:So,__wbindgen_is_string:xo,__wbg_msCrypto_6e7d3e1f92610cbb:Eo,__wbg_require_78a3dcfbdba9cbce:Co,__wbg_getRandomValues_805f1c3d65988a5a:Ao,__wbg_randomFillSync_6894564c2c334c42:Io,__wbg_log_4b5638ad60bdc54a:Ro,__wbg_log_89ca282a8a49b121:Oo,__wbg_get_57245cc7d7c7619d:ko,__wbg_length_6e3bbe7c8bd4dbd8:Mo,__wbg_new_1d9a920c6bfc44a8:To,__wbg_newnoargs_b5b063fc6c2f0376:Do,__wbg_next_579e583d33566a86:jo,__wbg_next_aaef7c8aa5e212ac:Po,__wbg_done_1b73b0672e15f234:Fo,__wbg_value_1ccc36bc03462d71:No,__wbg_iterator_6f9d4f28845f426c:Lo,__wbg_get_765201544a2b6869:Uo,__wbg_call_97ae9d8645dc388b:$o,__wbg_new_0b9bfdd97583284e:Bo,__wbg_self_6d479506f72c6a71:zo,__wbg_window_f2557cc78490aceb:Vo,__wbg_globalThis_7f206bda628d5286:Wo,__wbg_global_ba75c50d1cf384f4:Ho,__wbg_set_a68214f35c417fa9:Ko,__wbg_from_7ce3cb27cb258569:Yo,__wbg_isArray_27c46c67f498e15d:Jo,__wbg_push_740e4b286702d964:qo,__wbg_unshift_1bf718f5eb23ad8a:Go,__wbg_instanceof_ArrayBuffer_e5e48f4762c5610b:Xo,__wbg_new_8d2af00bc1e329ee:Qo,__wbg_call_168da88779e35f61:Zo,__wbg_call_e1f72c051cdab859:es,__wbg_instanceof_Date_b979044f17219415:ts,__wbg_getTime_cb82adb2556ed13e:ns,__wbg_new_c8631234f931e1c4:rs,__wbg_instanceof_Object_595a1007518cbea3:os,__wbg_assign_e3deabdbb7f0913d:ss,__wbg_defineProperty_e47dcaf04849e02c:is,__wbg_entries_65a76a413fc91037:as,__wbg_freeze_863b0fb5229a1aa6:cs,__wbg_keys_0702294afaeb6044:fs,__wbg_values_f72d246067c121fe:us,__wbg_for_5dcca67bf52b18ca:ls,__wbg_buffer_3f3d764d4747d564:ds,__wbg_newwithbyteoffsetandlength_d9aa266703cb98be:hs,__wbg_new_8c3f0052272a457a:gs,__wbg_set_83db9690f9353e79:_s,__wbg_length_9e1ae1900cb0fbd5:ys,__wbg_instanceof_Uint8Array_971eeda69eb75003:bs,__wbg_newwithlength_f5933855e4f48a19:ps,__wbg_subarray_58ad4efbb5bcb886:ms,__wbg_apply_75f7334893eef4ad:ws,__wbg_deleteProperty_424563545efc9635:vs,__wbg_ownKeys_bf24e1178641d9f0:Ss,__wbg_set_bf3f89b92d5a34bf:xs,__wbindgen_debug_string:Es,__wbindgen_throw:Cs,__wbindgen_memory:As}},va),rn=B.memory,Is=B.__wbg_automerge_free,Ua=B.automerge_new,$a=B.automerge_clone,Ba=B.automerge_fork,za=B.automerge_pendingOps,Va=B.automerge_commit,Wa=B.automerge_merge,Ha=B.automerge_rollback,Ka=B.automerge_keys,Ya=B.automerge_text,Ja=B.automerge_splice,qa=B.automerge_push,Ga=B.automerge_pushObject,Xa=B.automerge_insert,Qa=B.automerge_insertObject,Za=B.automerge_put,ec=B.automerge_putObject,tc=B.automerge_increment,nc=B.automerge_get,rc=B.automerge_getWithType,oc=B.automerge_getAll,sc=B.automerge_enableFreeze,ic=B.automerge_enablePatches,ac=B.automerge_registerDatatype,cc=B.automerge_applyPatches,fc=B.automerge_popPatches,uc=B.automerge_length,lc=B.automerge_delete,dc=B.automerge_save,hc=B.automerge_saveIncremental,gc=B.automerge_loadIncremental,_c=B.automerge_applyChanges,yc=B.automerge_getChanges,bc=B.automerge_getChangeByHash,pc=B.automerge_getChangesAdded,mc=B.automerge_getHeads,wc=B.automerge_getActorId,vc=B.automerge_getLastLocalChange,Sc=B.automerge_dump,xc=B.automerge_getMissingDeps,Ec=B.automerge_receiveSyncMessage,Cc=B.automerge_generateSyncMessage,Ac=B.automerge_toJS,Ic=B.automerge_materialize,Rc=B.create,Oc=B.load,kc=B.encodeChange,Mc=B.decodeChange,Tc=B.initSyncState,Dc=B.importSyncState,jc=B.exportSyncState,Pc=B.encodeSyncMessage,Fc=B.decodeSyncMessage,Nc=B.encodeSyncState,Lc=B.decodeSyncState,Rs=B.__wbg_syncstate_free,Uc=B.syncstate_sharedHeads,$c=B.syncstate_lastSentHeads,Bc=B.syncstate_set_lastSentHeads,zc=B.syncstate_set_sentHashes,Vc=B.syncstate_clone,Ne=B.__wbindgen_malloc,Le=B.__wbindgen_realloc,O=B.__wbindgen_add_to_stack_pointer,bt=B.__wbindgen_free,Wc=B.__wbindgen_exn_store;var Hc=Object.freeze({__proto__:null,create:Ia,load:Ra,encodeChange:Oa,decodeChange:ka,initSyncState:Ma,importSyncState:Ta,exportSyncState:Da,encodeSyncMessage:ja,decodeSyncMessage:Pa,encodeSyncState:Fa,decodeSyncState:Na,Automerge:We,SyncState:$e,__wbindgen_object_drop_ref:Xr,__wbindgen_string_new:Qr,__wbindgen_is_undefined:Zr,__wbindgen_object_clone_ref:eo,__wbindgen_number_get:to,__wbindgen_number_new:no,__wbindgen_is_function:ro,__wbindgen_string_get:oo,__wbindgen_boolean_get:so,__wbindgen_is_null:io,__wbindgen_json_serialize:ao,__wbindgen_error_new:co,__wbg_new_abda76e883ba8a5f:fo,__wbg_stack_658279fe44541cf6:uo,__wbg_error_f851667af71bcfc6:lo,__wbindgen_bigint_from_i64:ho,__wbindgen_bigint_from_u64:go,__wbindgen_is_object:_o,__wbindgen_jsval_loose_eq:yo,__wbg_String_91fba7ded13ba54c:bo,__wbg_set_20cbc34131e76824:po,__wbg_crypto_e1d53a1d73fb10b8:mo,__wbg_process_038c26bf42b093f8:wo,__wbg_versions_ab37218d2f0b24a8:vo,__wbg_node_080f4b19d15bc1fe:So,__wbindgen_is_string:xo,__wbg_msCrypto_6e7d3e1f92610cbb:Eo,__wbg_require_78a3dcfbdba9cbce:Co,__wbg_getRandomValues_805f1c3d65988a5a:Ao,__wbg_randomFillSync_6894564c2c334c42:Io,__wbg_log_4b5638ad60bdc54a:Ro,__wbg_log_89ca282a8a49b121:Oo,__wbg_get_57245cc7d7c7619d:ko,__wbg_length_6e3bbe7c8bd4dbd8:Mo,__wbg_new_1d9a920c6bfc44a8:To,__wbg_newnoargs_b5b063fc6c2f0376:Do,__wbg_next_579e583d33566a86:jo,__wbg_next_aaef7c8aa5e212ac:Po,__wbg_done_1b73b0672e15f234:Fo,__wbg_value_1ccc36bc03462d71:No,__wbg_iterator_6f9d4f28845f426c:Lo,__wbg_get_765201544a2b6869:Uo,__wbg_call_97ae9d8645dc388b:$o,__wbg_new_0b9bfdd97583284e:Bo,__wbg_self_6d479506f72c6a71:zo,__wbg_window_f2557cc78490aceb:Vo,__wbg_globalThis_7f206bda628d5286:Wo,__wbg_global_ba75c50d1cf384f4:Ho,__wbg_set_a68214f35c417fa9:Ko,__wbg_from_7ce3cb27cb258569:Yo,__wbg_isArray_27c46c67f498e15d:Jo,__wbg_push_740e4b286702d964:qo,__wbg_unshift_1bf718f5eb23ad8a:Go,__wbg_instanceof_ArrayBuffer_e5e48f4762c5610b:Xo,__wbg_new_8d2af00bc1e329ee:Qo,__wbg_call_168da88779e35f61:Zo,__wbg_call_e1f72c051cdab859:es,__wbg_instanceof_Date_b979044f17219415:ts,__wbg_getTime_cb82adb2556ed13e:ns,__wbg_new_c8631234f931e1c4:rs,__wbg_instanceof_Object_595a1007518cbea3:os,__wbg_assign_e3deabdbb7f0913d:ss,__wbg_defineProperty_e47dcaf04849e02c:is,__wbg_entries_65a76a413fc91037:as,__wbg_freeze_863b0fb5229a1aa6:cs,__wbg_keys_0702294afaeb6044:fs,__wbg_values_f72d246067c121fe:us,__wbg_for_5dcca67bf52b18ca:ls,__wbg_buffer_3f3d764d4747d564:ds,__wbg_newwithbyteoffsetandlength_d9aa266703cb98be:hs,__wbg_new_8c3f0052272a457a:gs,__wbg_set_83db9690f9353e79:_s,__wbg_length_9e1ae1900cb0fbd5:ys,__wbg_instanceof_Uint8Array_971eeda69eb75003:bs,__wbg_newwithlength_f5933855e4f48a19:ps,__wbg_subarray_58ad4efbb5bcb886:ms,__wbg_apply_75f7334893eef4ad:ws,__wbg_deleteProperty_424563545efc9635:vs,__wbg_ownKeys_bf24e1178641d9f0:Ss,__wbg_set_bf3f89b92d5a34bf:xs,__wbindgen_debug_string:Es,__wbindgen_throw:Cs,__wbindgen_memory:As}),Kc=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]]);return n};function Os(t){wa(t)}Os(Hc);function ks(t){return fe(t).handle}function fe(t,e=!0){if(typeof t!="object")throw new RangeError("must be the document root");const n=Reflect.get(t,Ze);if(n===void 0||n==null||e&&zn(t)!=="_root")throw new RangeError("must be the document root");return n}function Ms(t){return Reflect.get(t,ut)}function zn(t){return typeof t!="object"||t===null?null:Reflect.get(t,Ke)}function kt(t){return Reflect.get(t,nn)!==!1}function Vn(t){return typeof t=="object"?t:{actor:t}}function on(t){let e=Vn(t),n=!!e.freeze,r=e.patchCallback;const o=xe.create(e.actor);return o.enablePatches(!0),o.enableFreeze(!!e.freeze),o.registerDatatype("counter",a=>new lt(a)),o.registerDatatype("text",a=>new et(a)),o.materialize("/",void 0,{handle:o,heads:void 0,freeze:n,patchCallback:r})}function Yc(t,e){const n=fe(t),r=n.handle;return n.handle.materialize("/",e,Object.assign(Object.assign({},n),{handle:r,heads:e}))}function Jc(t,e){const n=fe(t),r=n.heads,o=Vn(e),s=n.handle.fork(o.actor,r),a=Kc(n,["heads"]);return s.applyPatches(t,Object.assign(Object.assign({},a),{handle:s}))}function qc(t){return fe(t).handle.free()}function Gc(t,e){return Wn(on(e),n=>Object.assign(n,t))}function Wn(t,e,n){if(typeof e=="function")return wr(t,{},e);if(typeof n=="function")return typeof e=="string"&&(e={message:e}),wr(t,e,n);throw RangeError("Invalid args for change")}function ht(t,e,n){let r=fe(t),o=Object.assign(Object.assign({},r),{heads:void 0}),s=r.handle.applyPatches(t,o,n);return r.heads=e,s}function wr(t,e,n){if(typeof n!="function")throw new RangeError("invalid change function");const r=fe(t);if(t===void 0||r===void 0)throw new RangeError("must be the document root");if(r.heads)throw new RangeError("Attempting to change an outdated document.  Use Automerge.clone() if you wish to make a writable copy.");if(kt(t)===!1)throw new RangeError("Calls to Automerge.change cannot be nested");const o=r.handle.getHeads();try{r.heads=o;const s=_a(r.handle);return n(s),r.handle.pendingOps()===0?(r.heads=void 0,t):(r.handle.commit(e.message,e.time),ht(t,o,e.patchCallback||r.patchCallback))}catch(s){throw r.heads=void 0,r.handle.rollback(),s}}function Xc(t,e){e===void 0&&(e={}),typeof e=="string"&&(e={message:e});const n=fe(t);if(n.heads)throw new RangeError("Attempting to change an outdated document.  Use Automerge.clone() if you wish to make a writable copy.");if(kt(t)===!1)throw new RangeError("Calls to Automerge.change cannot be nested");const r=n.handle.getHeads();return n.handle.commit(e.message,e.time),ht(t,r)}function Qc(t,e){const n=Vn(e),r=n.actor,o=n.patchCallback,s=xe.load(t,r);return s.enablePatches(!0),s.enableFreeze(!!n.freeze),s.registerDatatype("counter",u=>new lt(u)),s.registerDatatype("text",u=>new et(u)),s.materialize("/",void 0,{handle:s,heads:void 0,patchCallback:o})}function Ts(t,e,n){n||(n={});const r=fe(t);if(r.heads)throw new RangeError("Attempting to change an out of date document - set at: "+Ms(t));if(kt(t)===!1)throw new RangeError("Calls to Automerge.change cannot be nested");const o=r.handle.getHeads();return r.handle.loadIncremental(e),ht(t,o,n.patchCallback||r.patchCallback)}function Ds(t){return fe(t).handle.save()}function Zc(t,e){const n=fe(t);if(n.heads)throw new RangeError("Attempting to change an out of date document - set at: "+Ms(t));const r=n.handle.getHeads(),o=fe(e),s=n.handle.getChangesAdded(o.handle);return n.handle.applyChanges(s),ht(t,r,n.patchCallback)}function ef(t){return fe(t).handle.getActorId()}function tf(t,e,n){const r=t.getAll(e,n);if(r.length<=1)return;const o={};for(const s of r)switch(s[0]){case"map":o[s[1]]=dt(t,s[1],[n],!0);break;case"list":o[s[1]]=Rt(t,s[1],[n],!0);break;case"text":o[s[1]]=Ot(t,s[1],[n],!0);break;case"str":case"uint":case"int":case"f64":case"boolean":case"bytes":case"null":o[s[2]]=s[1];break;case"counter":o[s[2]]=new lt(s[1]);break;case"timestamp":o[s[2]]=new Date(s[1]);break;default:throw RangeError(`datatype ${s[0]} unimplemented`)}return o}function nf(t,e){const n=fe(t,!1),r=zn(t);if(r!=null)return tf(n.handle,r,e)}function rf(t){return fe(t).handle.getLastLocalChange()||void 0}function js(t){return zn(t)}function of(t,e){return fe(t),fe(e).handle.getChanges(Zt(t))}function Ps(t){return fe(t).handle.getChanges([])}function Fs(t,e,n){const r=fe(t);if(n||(n={}),r.heads)throw new RangeError("Attempting to change an outdated document.  Use Automerge.clone() if you wish to make a writable copy.");if(kt(t)===!1)throw new RangeError("Calls to Automerge.change cannot be nested");const o=r.handle.getHeads();return r.handle.applyChanges(e),r.heads=o,[ht(t,o,n.patchCallback||r.patchCallback)]}function sf(t){const e=Ps(t);return e.map((n,r)=>({get change(){return Qt(n)},get snapshot(){const[o]=Fs(on(),e.slice(0,r+1));return o}}))}function Ns(t,e){if(!vr(t)||!vr(e))return t===e;const n=Object.keys(t).sort(),r=Object.keys(e).sort();if(n.length!==r.length)return!1;for(let o=0;o<n.length;o++)if(n[o]!==r[o]||!Ns(t[n[o]],e[r[o]]))return!1;return!0}function Ls(t){const e=xe.importSyncState(t),n=xe.encodeSyncState(e);return e.free(),n}function Us(t){let e=xe.decodeSyncState(t),n=xe.exportSyncState(e);return e.free(),n}function $s(t,e){const n=fe(t),r=xe.importSyncState(e),o=n.handle.generateSyncMessage(r);return[xe.exportSyncState(r),o]}function Bs(t,e,n,r){const o=xe.importSyncState(e);r||(r={});const s=fe(t);if(s.heads)throw new RangeError("Attempting to change an outdated document.  Use Automerge.clone() if you wish to make a writable copy.");if(kt(t)===!1)throw new RangeError("Calls to Automerge.change cannot be nested");const a=s.handle.getHeads();s.handle.receiveSyncMessage(o,n);const u=xe.exportSyncState(o);return[ht(t,a,r.patchCallback||s.patchCallback),u,null]}function zs(){return xe.exportSyncState(xe.initSyncState())}function af(t){return xe.encodeChange(t)}function Qt(t){return xe.decodeChange(t)}function cf(t){return xe.encodeSyncMessage(t)}function kn(t){return xe.decodeSyncMessage(t)}function ff(t,e){return fe(t).handle.getMissingDeps(e)}function Zt(t){const e=fe(t);return e.heads||e.handle.getHeads()}function uf(t){fe(t).handle.dump()}function lf(t){const e=fe(t),n=e.handle.enableFreeze(!1),r=e.handle.materialize();return e.handle.enableFreeze(n),r}function df(t){return js(t)==="_root"&&!!Reflect.get(t,Ze)}function vr(t){return typeof t=="object"&&t!==null}var hf=Object.freeze({__proto__:null,use:Os,getBackend:ks,init:on,view:Yc,clone:Jc,free:qc,from:Gc,change:Wn,emptyChange:Xc,load:Qc,loadIncremental:Ts,save:Ds,merge:Zc,getActorId:ef,getConflicts:nf,getLastLocalChange:rf,getObjectId:js,getChanges:of,getAllChanges:Ps,applyChanges:Fs,getHistory:sf,equals:Ns,encodeSyncState:Ls,decodeSyncState:Us,generateSyncMessage:$s,receiveSyncMessage:Bs,initSyncState:zs,encodeChange:af,decodeChange:Qt,encodeSyncMessage:cf,decodeSyncMessage:kn,getMissingDeps:ff,getHeads:Zt,dump:uf,toJS:lf,isAutomerge:df,uuid:Bn,Text:et,Counter:lt,Int:ba,Uint:pa,Float64:ma}),Mn={exports:{}},wn,Sr;function gf(){if(Sr)return wn;Sr=1;var t=1e3,e=t*60,n=e*60,r=n*24,o=r*7,s=r*365.25;wn=function(_,d){d=d||{};var v=typeof _;if(v==="string"&&_.length>0)return a(_);if(v==="number"&&isFinite(_))return d.long?c(_):u(_);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(_))};function a(_){if(_=String(_),!(_.length>100)){var d=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(_);if(!!d){var v=parseFloat(d[1]),L=(d[2]||"ms").toLowerCase();switch(L){case"years":case"year":case"yrs":case"yr":case"y":return v*s;case"weeks":case"week":case"w":return v*o;case"days":case"day":case"d":return v*r;case"hours":case"hour":case"hrs":case"hr":case"h":return v*n;case"minutes":case"minute":case"mins":case"min":case"m":return v*e;case"seconds":case"second":case"secs":case"sec":case"s":return v*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return v;default:return}}}}function u(_){var d=Math.abs(_);return d>=r?Math.round(_/r)+"d":d>=n?Math.round(_/n)+"h":d>=e?Math.round(_/e)+"m":d>=t?Math.round(_/t)+"s":_+"ms"}function c(_){var d=Math.abs(_);return d>=r?h(_,d,r,"day"):d>=n?h(_,d,n,"hour"):d>=e?h(_,d,e,"minute"):d>=t?h(_,d,t,"second"):_+" ms"}function h(_,d,v,L){var $=d>=v*1.5;return Math.round(_/v)+" "+L+($?"s":"")}return wn}function _f(t){n.debug=n,n.default=n,n.coerce=c,n.disable=s,n.enable=o,n.enabled=a,n.humanize=gf(),n.destroy=h,Object.keys(t).forEach(_=>{n[_]=t[_]}),n.names=[],n.skips=[],n.formatters={};function e(_){let d=0;for(let v=0;v<_.length;v++)d=(d<<5)-d+_.charCodeAt(v),d|=0;return n.colors[Math.abs(d)%n.colors.length]}n.selectColor=e;function n(_){let d,v=null,L,$;function H(...j){if(!H.enabled)return;const oe=H,te=Number(new Date),W=te-(d||te);oe.diff=W,oe.prev=d,oe.curr=te,d=te,j[0]=n.coerce(j[0]),typeof j[0]!="string"&&j.unshift("%O");let me=0;j[0]=j[0].replace(/%([a-zA-Z%])/g,(J,q)=>{if(J==="%%")return"%";me++;const Z=n.formatters[q];if(typeof Z=="function"){const ue=j[me];J=Z.call(oe,ue),j.splice(me,1),me--}return J}),n.formatArgs.call(oe,j),(oe.log||n.log).apply(oe,j)}return H.namespace=_,H.useColors=n.useColors(),H.color=n.selectColor(_),H.extend=r,H.destroy=n.destroy,Object.defineProperty(H,"enabled",{enumerable:!0,configurable:!1,get:()=>v!==null?v:(L!==n.namespaces&&(L=n.namespaces,$=n.enabled(_)),$),set:j=>{v=j}}),typeof n.init=="function"&&n.init(H),H}function r(_,d){const v=n(this.namespace+(typeof d>"u"?":":d)+_);return v.log=this.log,v}function o(_){n.save(_),n.namespaces=_,n.names=[],n.skips=[];let d;const v=(typeof _=="string"?_:"").split(/[\s,]+/),L=v.length;for(d=0;d<L;d++)!v[d]||(_=v[d].replace(/\*/g,".*?"),_[0]==="-"?n.skips.push(new RegExp("^"+_.slice(1)+"$")):n.names.push(new RegExp("^"+_+"$")))}function s(){const _=[...n.names.map(u),...n.skips.map(u).map(d=>"-"+d)].join(",");return n.enable(""),_}function a(_){if(_[_.length-1]==="*")return!0;let d,v;for(d=0,v=n.skips.length;d<v;d++)if(n.skips[d].test(_))return!1;for(d=0,v=n.names.length;d<v;d++)if(n.names[d].test(_))return!0;return!1}function u(_){return _.toString().substring(2,_.toString().length-2).replace(/\.\*\?$/,"*")}function c(_){return _ instanceof Error?_.stack||_.message:_}function h(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return n.enable(n.load()),n}var yf=_f;(function(t,e){e.formatArgs=r,e.save=o,e.load=s,e.useColors=n,e.storage=a(),e.destroy=(()=>{let c=!1;return()=>{c||(c=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function n(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function r(c){if(c[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+c[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const h="color: "+this.color;c.splice(1,0,h,"color: inherit");let _=0,d=0;c[0].replace(/%[a-zA-Z%]/g,v=>{v!=="%%"&&(_++,v==="%c"&&(d=_))}),c.splice(d,0,h)}e.log=console.debug||console.log||(()=>{});function o(c){try{c?e.storage.setItem("debug",c):e.storage.removeItem("debug")}catch{}}function s(){let c;try{c=e.storage.getItem("debug")}catch{}return!c&&typeof process<"u"&&"env"in process&&(c=process.env.DEBUG),c}function a(){try{return localStorage}catch{}}t.exports=yf(e);const{formatters:u}=t.exports;u.j=function(c){try{return JSON.stringify(c)}catch(h){return"[UnexpectedJSONParseError]: "+h.message}}})(Mn,Mn.exports);var Be=Mn.exports;const tt=Be("DocHandle");class bf extends Ye{doc;documentId;state="loading";constructor(e,n=!1){super(),this.documentId=e,this.doc=on({patchCallback:(r,o,s)=>this.__notifyPatchListeners(r,o,s)}),n&&(this.state="ready",this.emit("ready"))}ready(){return this.state==="ready"}loadIncremental(e){tt(`[${this.documentId}]: loadIncremental`,this.doc);const n=Ts(this.doc,e);this.state==="loading"&&(this.state="ready",this.emit("ready")),this.__notifyChangeListeners(n)}unblockSync(){this.state==="loading"&&(this.state="syncing",this.emit("syncing"))}updateDoc(e){tt(`[${this.documentId}]: updateDoc`,this.doc),this.__notifyChangeListeners(e(this.doc))}__notifyChangeListeners(e){if("then"in e)throw new Error("this appears to be a promise");const n=this.doc;this.doc=e,((o,s)=>o.length===s.length&&o.every((a,u)=>a===s[u]))(Zt(e),Zt(n))||(this.state!="ready"&&(this.state="ready",this.emit("ready")),this.emit("change",{handle:this}))}__notifyPatchListeners(e,n,r){this.emit("patch",{handle:this,patch:e,before:n,after:r})}async value(){return this.ready()?await new Promise(e=>setTimeout(()=>e(!0),0)):(tt(`[${this.documentId}]: value: (${this.state}, waiting for ready)`),await new Promise(e=>this.once("ready",()=>e(!0)))),tt(`[${this.documentId}]: value:`,this.doc),this.doc}async syncValue(){return tt(`[${this.documentId}]: syncValue,`,this.doc),this.state=="loading"?(tt(`[${this.documentId}]: value: (${this.state}, waiting for syncing)`),await new Promise(e=>{this.once("syncing",()=>e(!0)),this.once("ready",()=>e(!0))})):await new Promise(e=>setTimeout(()=>e(!0),0)),tt(`[${this.documentId}]: syncValue:`,this.doc),this.doc}change(e,n={}){this.value().then(()=>{const r=Wn(this.doc,n,e);this.__notifyChangeListeners(r)})}}class pf extends Ye{handles={};constructor(){super()}cacheHandle(e,n){if(this.handles[e])return this.handles[e];const r=new bf(e,n);return this.handles[e]=r,r}create(){const e=oa(),n=this.cacheHandle(e,!0);return this.emit("document",{handle:n}),n}find(e){if(this.handles[e])return this.handles[e];const n=this.cacheHandle(e,!1);return this.emit("document",{handle:n}),n}}const xr=Be("NetworkSubsystem");class mf extends Ye{networkAdapters=[];myPeerId;peerIdToAdapter={};channels;constructor(e,n){super(),this.myPeerId=n||`user-${Math.round(Math.random()*1e5)}`,xr("local peerID: ",this.myPeerId),this.channels=[],this.networkAdapters=e,e.forEach(r=>this.addNetworkAdapter(r))}addNetworkAdapter(e){e.connect(this.myPeerId),e.on("peer-candidate",({peerId:n,channelId:r})=>{this.peerIdToAdapter[n]||(this.peerIdToAdapter[n]=e),this.emit("peer",{peerId:n,channelId:r})}),e.on("peer-disconnected",({peerId:n})=>{delete this.peerIdToAdapter[n],this.emit("peer-disconnected",{peerId:n})}),e.on("message",n=>{const{senderId:r,targetId:o,channelId:s,broadcast:a,message:u}=n;a&&Object.entries(this.peerIdToAdapter).filter(([c])=>c!==r).forEach(([c,h])=>{h.sendMessage(c,s,u,a)}),this.emit("message",n)}),e.on("close",()=>{Object.entries(this.peerIdToAdapter).forEach(([n,r])=>{r===e&&delete this.peerIdToAdapter[n]})}),this.channels.forEach(n=>e.join(n))}sendMessage(e,n,r,o){if(o)Object.entries(this.peerIdToAdapter).forEach(([s,a])=>{a.sendMessage(s,n,r,!0)});else{const s=this.peerIdToAdapter[e];if(!s){xr(`Tried to send message to disconnected peer: ${e}`);return}s.sendMessage(e,n,r,!1)}}join(e){this.channels.push(e),this.networkAdapters.forEach(n=>n.join(e))}leave(e){this.channels=this.channels.filter(n=>n!==e),this.networkAdapters.forEach(n=>n.leave(e))}}let Tn;try{Tn=new TextDecoder}catch{}let z,rt,x=0;const wf=105,vf=57342,Sf=57343,Er=57337,Cr=6,it={};let re={},le,en,tn=0,Ct=0,pe,je,ge=[],Dn=[],Oe,Ie,pt,Ar={useRecords:!1,mapsAsObjects:!0},At=!1;class It{constructor(e){if(e&&((e.keyMap||e._keyMap)&&!e.useRecords&&(e.useRecords=!1,e.mapsAsObjects=!0),e.useRecords===!1&&e.mapsAsObjects===void 0&&(e.mapsAsObjects=!0),e.getStructures&&(e.getShared=e.getStructures),e.getShared&&!e.structures&&((e.structures=[]).uninitialized=!0),e.keyMap)){this.mapKey=new Map;for(let[n,r]of Object.entries(e.keyMap))this.mapKey.set(r,n)}Object.assign(this,e)}decodeKey(e){return this.keyMap&&this.mapKey.get(e)||e}encodeKey(e){return this.keyMap&&this.keyMap.hasOwnProperty(e)?this.keyMap[e]:e}encodeKeys(e){if(!this._keyMap)return e;let n=new Map;for(let[r,o]of Object.entries(e))n.set(this._keyMap.hasOwnProperty(r)?this._keyMap[r]:r,o);return n}decodeKeys(e){if(!this._keyMap||e.constructor.name!="Map")return e;if(!this._mapKey){this._mapKey=new Map;for(let[r,o]of Object.entries(this._keyMap))this._mapKey.set(o,r)}let n={};return e.forEach((r,o)=>n[Ue(this._mapKey.has(o)?this._mapKey.get(o):o)]=r),n}mapDecode(e,n){let r=this.decode(e);if(this._keyMap)switch(r.constructor.name){case"Array":return r.map(o=>this.decodeKeys(o))}return r}decode(e,n){if(z)return Ks(()=>(Nn(),this?this.decode(e,n):It.prototype.decode.call(Ar,e,n)));rt=n>-1?n:e.length,x=0,Ct=0,en=null,pe=null,z=e;try{Ie=e.dataView||(e.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength))}catch(r){throw z=null,e instanceof Uint8Array?r:new Error("Source must be a Uint8Array or Buffer but was a "+(e&&typeof e=="object"?e.constructor.name:typeof e))}if(this instanceof It){if(re=this,Oe=this.sharedValues&&(this.pack?new Array(this.maxPrivatePackedValues||16).concat(this.sharedValues):this.sharedValues),this.structures)return le=this.structures,Ut();(!le||le.length>0)&&(le=[])}else re=Ar,(!le||le.length>0)&&(le=[]),Oe=null;return Ut()}decodeMultiple(e,n){let r,o=0;try{let s=e.length;At=!0;let a=this?this.decode(e,s):Yn.decode(e,s);if(n){if(n(a)===!1)return;for(;x<s;)if(o=x,n(Ut())===!1)return}else{for(r=[a];x<s;)o=x,r.push(Ut());return r}}catch(s){throw s.lastPosition=o,s.values=r,s}finally{At=!1,Nn()}}}function Ut(){try{let t=se();if(pe){if(x>=pe.postBundlePosition){let e=new Error("Unexpected bundle position");throw e.incomplete=!0,e}x=pe.postBundlePosition,pe=null}if(x==rt)le=null,z=null,je&&(je=null);else if(x>rt){let e=new Error("Unexpected end of CBOR data");throw e.incomplete=!0,e}else if(!At)throw new Error("Data read, but end of buffer not reached");return t}catch(t){throw Nn(),(t instanceof RangeError||t.message.startsWith("Unexpected end of buffer"))&&(t.incomplete=!0),t}}function se(){let t=z[x++],e=t>>5;if(t=t&31,t>23)switch(t){case 24:t=z[x++];break;case 25:if(e==7)return Af();t=Ie.getUint16(x),x+=2;break;case 26:if(e==7){let n=Ie.getFloat32(x);if(re.useFloat32>2){let r=Kn[(z[x]&127)<<1|z[x+1]>>7];return x+=4,(r*n+(n>0?.5:-.5)>>0)/r}return x+=4,n}t=Ie.getUint32(x),x+=4;break;case 27:if(e==7){let n=Ie.getFloat64(x);return x+=8,n}if(e>1){if(Ie.getUint32(x)>0)throw new Error("JavaScript does not support arrays, maps, or strings with length over 4294967295");t=Ie.getUint32(x+4)}else re.int64AsNumber?(t=Ie.getUint32(x)*4294967296,t+=Ie.getUint32(x+4)):t=Ie.getBigUint64(x);x+=8;break;case 31:switch(e){case 2:case 3:throw new Error("Indefinite length not supported for byte or text strings");case 4:let n=[],r,o=0;for(;(r=se())!=it;)n[o++]=r;return e==4?n:e==3?n.join(""):Buffer.concat(n);case 5:let s;if(re.mapsAsObjects){let a={};if(re.keyMap)for(;(s=se())!=it;)a[Ue(re.decodeKey(s))]=se();else for(;(s=se())!=it;)a[Ue(s)]=se();return a}else{pt&&(re.mapsAsObjects=!0,pt=!1);let a=new Map;if(re.keyMap)for(;(s=se())!=it;)a.set(re.decodeKey(s),se());else for(;(s=se())!=it;)a.set(s,se());return a}case 7:return it;default:throw new Error("Invalid major type for indefinite length "+e)}default:throw new Error("Unknown token "+t)}switch(e){case 0:return t;case 1:return~t;case 2:return Cf(t);case 3:if(Ct>=x)return en.slice(x-tn,(x+=t)-tn);if(Ct==0&&rt<140&&t<32){let o=t<16?Vs(t):Ef(t);if(o!=null)return o}return xf(t);case 4:let n=new Array(t);for(let o=0;o<t;o++)n[o]=se();return n;case 5:if(re.mapsAsObjects){let o={};if(re.keyMap)for(let s=0;s<t;s++)o[Ue(re.decodeKey(se()))]=se();else for(let s=0;s<t;s++)o[Ue(se())]=se();return o}else{pt&&(re.mapsAsObjects=!0,pt=!1);let o=new Map;if(re.keyMap)for(let s=0;s<t;s++)o.set(re.decodeKey(se()),se());else for(let s=0;s<t;s++)o.set(se(),se());return o}case 6:if(t>=Er){let o=le[t&8191];if(o)return o.read||(o.read=jn(o)),o.read();if(t<65536){if(t==Sf)return Fn(se());if(t==vf){let s=mt(),a=se();for(let u=2;u<s;u++)Fn([a++,se()]);return se()}else if(t==Er)return Tf();if(re.getShared&&(Hn(),o=le[t&8191],o))return o.read||(o.read=jn(o)),o.read()}}let r=ge[t];if(r)return r.handlesRead?r(se):r(se());{let o=se();for(let s=0;s<Dn.length;s++){let a=Dn[s](t,o);if(a!==void 0)return a}return new ot(o,t)}case 7:switch(t){case 20:return!1;case 21:return!0;case 22:return null;case 23:return;case 31:default:let o=(Oe||nt())[t];if(o!==void 0)return o;throw new Error("Unknown token "+t)}default:if(isNaN(t)){let o=new Error("Unexpected end of CBOR data");throw o.incomplete=!0,o}throw new Error("Unknown CBOR token "+t)}}const Ir=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function jn(t){function e(){let n=z[x++];if(n=n&31,n>23)switch(n){case 24:n=z[x++];break;case 25:n=Ie.getUint16(x),x+=2;break;case 26:n=Ie.getUint32(x),x+=4;break;default:throw new Error("Expected array header, but got "+z[x-1])}let r=this.compiledReader;for(;r;){if(r.propertyCount===n)return r(se);r=r.next}if(this.slowReads++>=3){let s=this.length==n?this:this.slice(0,n);return r=re.keyMap?new Function("r","return {"+s.map(a=>re.decodeKey(a)).map(a=>Ir.test(a)?Ue(a)+":r()":"["+JSON.stringify(a)+"]:r()").join(",")+"}"):new Function("r","return {"+s.map(a=>Ir.test(a)?Ue(a)+":r()":"["+JSON.stringify(a)+"]:r()").join(",")+"}"),this.compiledReader&&(r.next=this.compiledReader),r.propertyCount=n,this.compiledReader=r,r(se)}let o={};if(re.keyMap)for(let s=0;s<n;s++)o[Ue(re.decodeKey(this[s]))]=se();else for(let s=0;s<n;s++)o[Ue(this[s])]=se();return o}return t.slowReads=0,e}function Ue(t){return t==="__proto__"?"__proto_":t}let xf=Pn;function Pn(t){let e;if(t<16&&(e=Vs(t)))return e;if(t>64&&Tn)return Tn.decode(z.subarray(x,x+=t));const n=x+t,r=[];for(e="";x<n;){const o=z[x++];if((o&128)===0)r.push(o);else if((o&224)===192){const s=z[x++]&63;r.push((o&31)<<6|s)}else if((o&240)===224){const s=z[x++]&63,a=z[x++]&63;r.push((o&31)<<12|s<<6|a)}else if((o&248)===240){const s=z[x++]&63,a=z[x++]&63,u=z[x++]&63;let c=(o&7)<<18|s<<12|a<<6|u;c>65535&&(c-=65536,r.push(c>>>10&1023|55296),c=56320|c&1023),r.push(c)}else r.push(o);r.length>=4096&&(e+=we.apply(String,r),r.length=0)}return r.length>0&&(e+=we.apply(String,r)),e}let we=String.fromCharCode;function Ef(t){let e=x,n=new Array(t);for(let r=0;r<t;r++){const o=z[x++];if((o&128)>0){x=e;return}n[r]=o}return we.apply(String,n)}function Vs(t){if(t<4)if(t<2){if(t===0)return"";{let e=z[x++];if((e&128)>1){x-=1;return}return we(e)}}else{let e=z[x++],n=z[x++];if((e&128)>0||(n&128)>0){x-=2;return}if(t<3)return we(e,n);let r=z[x++];if((r&128)>0){x-=3;return}return we(e,n,r)}else{let e=z[x++],n=z[x++],r=z[x++],o=z[x++];if((e&128)>0||(n&128)>0||(r&128)>0||(o&128)>0){x-=4;return}if(t<6){if(t===4)return we(e,n,r,o);{let s=z[x++];if((s&128)>0){x-=5;return}return we(e,n,r,o,s)}}else if(t<8){let s=z[x++],a=z[x++];if((s&128)>0||(a&128)>0){x-=6;return}if(t<7)return we(e,n,r,o,s,a);let u=z[x++];if((u&128)>0){x-=7;return}return we(e,n,r,o,s,a,u)}else{let s=z[x++],a=z[x++],u=z[x++],c=z[x++];if((s&128)>0||(a&128)>0||(u&128)>0||(c&128)>0){x-=8;return}if(t<10){if(t===8)return we(e,n,r,o,s,a,u,c);{let h=z[x++];if((h&128)>0){x-=9;return}return we(e,n,r,o,s,a,u,c,h)}}else if(t<12){let h=z[x++],_=z[x++];if((h&128)>0||(_&128)>0){x-=10;return}if(t<11)return we(e,n,r,o,s,a,u,c,h,_);let d=z[x++];if((d&128)>0){x-=11;return}return we(e,n,r,o,s,a,u,c,h,_,d)}else{let h=z[x++],_=z[x++],d=z[x++],v=z[x++];if((h&128)>0||(_&128)>0||(d&128)>0||(v&128)>0){x-=12;return}if(t<14){if(t===12)return we(e,n,r,o,s,a,u,c,h,_,d,v);{let L=z[x++];if((L&128)>0){x-=13;return}return we(e,n,r,o,s,a,u,c,h,_,d,v,L)}}else{let L=z[x++],$=z[x++];if((L&128)>0||($&128)>0){x-=14;return}if(t<15)return we(e,n,r,o,s,a,u,c,h,_,d,v,L,$);let H=z[x++];if((H&128)>0){x-=15;return}return we(e,n,r,o,s,a,u,c,h,_,d,v,L,$,H)}}}}}function Cf(t){return re.copyBuffers?Uint8Array.prototype.slice.call(z,x,x+=t):z.subarray(x,x+=t)}let Ws=new Float32Array(1),$t=new Uint8Array(Ws.buffer,0,4);function Af(){let t=z[x++],e=z[x++],n=(t&127)>>2;if(n===31)return e||t&3?NaN:t&128?-1/0:1/0;if(n===0){let r=((t&3)<<8|e)/16777216;return t&128?-r:r}return $t[3]=t&128|(n>>1)+56,$t[2]=(t&7)<<5|e>>3,$t[1]=e<<5,$t[0]=0,Ws[0]}new Array(4096);class ot{constructor(e,n){this.value=e,this.tag=n}}ge[0]=t=>new Date(t);ge[1]=t=>new Date(Math.round(t*1e3));ge[2]=t=>{let e=BigInt(0);for(let n=0,r=t.byteLength;n<r;n++)e=BigInt(t[n])+e<<BigInt(8);return e};ge[3]=t=>BigInt(-1)-ge[2](t);ge[4]=t=>+(t[1]+"e"+t[0]);ge[5]=t=>t[1]*Math.exp(t[0]*Math.log(2));const Fn=t=>{let e=t[0]-57344,n=t[1],r=le[e];r&&r.isShared&&((le.restoreStructures||(le.restoreStructures=[]))[e]=r),le[e]=n,n.read=jn(n);let o={};if(re.keyMap)for(let s=2,a=t.length;s<a;s++){let u=re.decodeKey(n[s-2]);o[Ue(u)]=t[s]}else for(let s=2,a=t.length;s<a;s++){let u=n[s-2];o[Ue(u)]=t[s]}return o};ge[wf]=Fn;ge[14]=t=>pe?pe[0].slice(pe.position0,pe.position0+=t):new ot(t,14);ge[15]=t=>pe?pe[1].slice(pe.position1,pe.position1+=t):new ot(t,15);let If={Error,RegExp};ge[27]=t=>(If[t[0]]||Error)(t[1],t[2]);const Hs=t=>{if(z[x++]!=132)throw new Error("Packed values structure must be followed by a 4 element array");let e=t();return Oe=Oe?e.concat(Oe.slice(e.length)):e,Oe.prefixes=t(),Oe.suffixes=t(),t()};Hs.handlesRead=!0;ge[51]=Hs;ge[Cr]=t=>{if(!Oe)if(re.getShared)Hn();else return new ot(t,Cr);if(typeof t=="number")return Oe[16+(t>=0?2*t:-2*t-1)];throw new Error("No support for non-integer packed references yet")};ge[28]=t=>{je||(je=new Map,je.id=0);let e=je.id++,n=z[x],r;n>>5==4?r=[]:r={};let o={target:r};je.set(e,o);let s=t();return o.used?Object.assign(r,s):(o.target=s,s)};ge[28].handlesRead=!0;ge[29]=t=>{let e=je.get(t);return e.used=!0,e.target};ge[258]=t=>new Set(t);(ge[259]=t=>(re.mapsAsObjects&&(re.mapsAsObjects=!1,pt=!0),t())).handlesRead=!0;function at(t,e){return typeof t=="string"?t+e:t instanceof Array?t.concat(e):Object.assign({},t,e)}function nt(){if(!Oe)if(re.getShared)Hn();else throw new Error("No packed values available");return Oe}const Rf=1399353956;Dn.push((t,e)=>{if(t>=225&&t<=255)return at(nt().prefixes[t-224],e);if(t>=28704&&t<=32767)return at(nt().prefixes[t-28672],e);if(t>=1879052288&&t<=2147483647)return at(nt().prefixes[t-1879048192],e);if(t>=216&&t<=223)return at(e,nt().suffixes[t-216]);if(t>=27647&&t<=28671)return at(e,nt().suffixes[t-27639]);if(t>=1811940352&&t<=1879048191)return at(e,nt().suffixes[t-1811939328]);if(t==Rf)return{packedValues:Oe,structures:le.slice(0),version:e};if(t==55799)return e});const Of=new Uint8Array(new Uint16Array([1]).buffer)[0]==1,Rr=[Uint8Array,Uint8ClampedArray,Uint16Array,Uint32Array,typeof BigUint64Array>"u"?{name:"BigUint64Array"}:BigUint64Array,Int8Array,Int16Array,Int32Array,typeof BigInt64Array>"u"?{name:"BigInt64Array"}:BigInt64Array,Float32Array,Float64Array],kf=[64,68,69,70,71,72,77,78,79,85,86];for(let t=0;t<Rr.length;t++)Mf(Rr[t],kf[t]);function Mf(t,e){let n="get"+t.name.slice(0,-5);typeof t!="function"&&(t=null);let r=t.BYTES_PER_ELEMENT;for(let o=0;o<2;o++){if(!o&&r==1)continue;let s=r==2?1:r==4?2:3;ge[o?e:e-4]=r==1||o==Of?a=>{if(!t)throw new Error("Could not find typed array for code "+e);return new t(Uint8Array.prototype.slice.call(a,0).buffer)}:a=>{if(!t)throw new Error("Could not find typed array for code "+e);let u=new DataView(a.buffer,a.byteOffset,a.byteLength),c=a.length>>s,h=new t(c),_=u[n];for(let d=0;d<c;d++)h[d]=_.call(u,d<<s,o);return h}}}function Tf(){let t=mt(),e=x+se();for(let r=2;r<t;r++){let o=mt();x+=o}let n=x;return x=e,pe=[Pn(mt()),Pn(mt())],pe.position0=0,pe.position1=0,pe.postBundlePosition=x,x=n,se()}function mt(){let t=z[x++]&31;if(t>23)switch(t){case 24:t=z[x++];break;case 25:t=Ie.getUint16(x),x+=2;break;case 26:t=Ie.getUint32(x),x+=4;break}return t}function Hn(){if(re.getShared){let t=Ks(()=>(z=null,re.getShared()))||{},e=t.structures||[];re.sharedVersion=t.version,Oe=re.sharedValues=t.packedValues,le===!0?re.structures=le=e:le.splice.apply(le,[0,e.length].concat(e))}}function Ks(t){let e=rt,n=x,r=tn,o=Ct,s=en,a=je,u=pe,c=new Uint8Array(z.slice(0,rt)),h=le,_=re,d=At,v=t();return rt=e,x=n,tn=r,Ct=o,en=s,je=a,pe=u,z=c,At=d,le=h,re=_,Ie=new DataView(z.buffer,z.byteOffset,z.byteLength),v}function Nn(){z=null,je=null,le=null}const Kn=new Array(147);for(let t=0;t<256;t++)Kn[t]=+("1e"+Math.floor(45.15-t*.30103));let Yn=new It({useRecords:!1});const Ys=Yn.decode;Yn.decodeMultiple;let Kt;try{Kt=new TextEncoder}catch{}let Ln,Js;const Mt=typeof Buffer<"u",vn=Mt?Buffer.allocUnsafeSlow:Uint8Array,Or=Mt?Buffer:Uint8Array,Sn=typeof Blob>"u"?{}:Blob,kr=256,Mr=Mt?4294967296:2144337920;let xn,m,ce,g=0,Qe,ye=null;const Df=61440,jf=/[\u0080-\uFFFF]/,ke=Symbol("record-id");class Pf extends It{constructor(e){super(e),this.offset=0;let n,r,o,s,a;e=e||{};let u=Or.prototype.utf8Write?function(w,U,R){return m.utf8Write(w,U,R)}:Kt&&Kt.encodeInto?function(w,U){return Kt.encodeInto(w,m.subarray(U)).written}:!1,c=this,h=e.structures||e.saveStructures,_=e.maxSharedStructures;if(_==null&&(_=h?128:0),_>8190)throw new Error("Maximum maxSharedStructure is 8190");let d=e.sequential;d&&(_=0),this.structures||(this.structures=[]),this.saveStructures&&(this.saveShared=this.saveStructures);let v,L,$=e.sharedValues,H;if($){H=Object.create(null);for(let w=0,U=$.length;w<U;w++)H[$[w]]=w}let j=[],oe=0,te=0;this.mapEncode=function(w,U){if(this._keyMap&&!this._mapped)switch(w.constructor.name){case"Array":w=w.map(R=>this.encodeKeys(R));break}return this.encode(w,U)},this.encode=function(w,U){if(m||(m=new vn(8192),ce=new DataView(m.buffer,0,8192),g=0),Qe=m.length-10,Qe-g<2048?(m=new vn(m.length),ce=new DataView(m.buffer,0,m.length),Qe=m.length-10,g=0):U===Pr&&(g=g+7&2147483640),n=g,c.useSelfDescribedHeader&&(ce.setUint32(g,3654940416),g+=3),a=c.structuredClone?new Map:null,c.bundleStrings&&typeof w!="string"?(ye=[],ye.size=1/0):ye=null,r=c.structures,r){if(r.uninitialized){let T=c.getShared()||{};c.structures=r=T.structures||[],c.sharedVersion=T.version;let A=c.sharedValues=T.packedValues;if(A){H={};for(let K=0,X=A.length;K<X;K++)H[A[K]]=K}}let R=r.length;if(R>_&&!d&&(R=_),!r.transitions){r.transitions=Object.create(null);for(let T=0;T<R;T++){let A=r[T];if(!A)continue;let K,X=r.transitions;for(let G=0,Y=A.length;G<Y;G++){X[ke]===void 0&&(X[ke]=T);let ee=A[G];K=X[ee],K||(K=X[ee]=Object.create(null)),X=K}X[ke]=T|1048576}}d||(r.nextId=R)}if(o&&(o=!1),s=r||[],L=H,e.pack){let R=new Map;if(R.values=[],R.encoder=c,R.maxValues=e.maxPrivatePackedValues||(H?16:1/0),R.objectMap=H||!1,R.samplingPackedValues=v,Yt(w,R),R.values.length>0){m[g++]=216,m[g++]=51,Ve(4);let T=R.values;W(T),Ve(0),Ve(0),L=Object.create(H||null);for(let A=0,K=T.length;A<K;A++)L[T[A]]=A}}xn=U&En;try{if(xn)return;if(W(w),ye&&jr(n,W),c.offset=g,a&&a.idsToInsert){g+=a.idsToInsert.length*2,g>Qe&&F(g),c.offset=g;let R=Nf(m.subarray(n,g),a.idsToInsert);return a=null,R}return U&Pr?(m.start=n,m.end=g,m):m.subarray(n,g)}finally{if(r){if(te<10&&te++,r.length>_&&(r.length=_),oe>1e4)r.transitions=null,te=0,oe=0,j.length>0&&(j=[]);else if(j.length>0&&!d){for(let R=0,T=j.length;R<T;R++)j[R][ke]=void 0;j=[]}}if(o&&c.saveShared){c.structures.length>_&&(c.structures=c.structures.slice(0,_));let R=m.subarray(n,g);return c.updateSharedData()===!1?c.encode(w):R}U&Lf&&(g=n)}},this.findCommonStringsToPack=()=>(v=new Map,H||(H=Object.create(null)),w=>{let U=w&&w.threshold||4,R=this.pack?w.maxPrivatePackedValues||16:0;$||($=this.sharedValues=[]);for(let[T,A]of v)A.count>U&&(H[T]=R++,$.push(T),o=!0);for(;this.saveShared&&this.updateSharedData()===!1;);v=null});const W=w=>{g>Qe&&(m=F(g));var U=typeof w,R;if(U==="string"){if(L){let X=L[w];if(X>=0){X<16?m[g++]=X+224:(m[g++]=198,X&1?W(15-X>>1):W(X-16>>1));return}else if(v&&!e.pack){let G=v.get(w);G?G.count++:v.set(w,{count:1})}}let T=w.length;if(ye&&T>=4&&T<1024){if((ye.size+=T)>Df){let G,Y=(ye[0]?ye[0].length*3+ye[1].length:0)+10;g+Y>Qe&&(m=F(g+Y)),m[g++]=217,m[g++]=223,m[g++]=249,m[g++]=ye.position?132:130,m[g++]=26,G=g-n,g+=4,ye.position&&jr(n,W),ye=["",""],ye.size=0,ye.position=G}let X=jf.test(w);ye[X?0:1]+=w,m[g++]=X?206:207,W(T);return}let A;T<32?A=1:T<256?A=2:T<65536?A=3:A=5;let K=T*3;if(g+K>Qe&&(m=F(g+K)),T<64||!u){let X,G,Y,ee=g+A;for(X=0;X<T;X++)G=w.charCodeAt(X),G<128?m[ee++]=G:G<2048?(m[ee++]=G>>6|192,m[ee++]=G&63|128):(G&64512)===55296&&((Y=w.charCodeAt(X+1))&64512)===56320?(G=65536+((G&1023)<<10)+(Y&1023),X++,m[ee++]=G>>18|240,m[ee++]=G>>12&63|128,m[ee++]=G>>6&63|128,m[ee++]=G&63|128):(m[ee++]=G>>12|224,m[ee++]=G>>6&63|128,m[ee++]=G&63|128);R=ee-g-A}else R=u(w,g+A,K);R<24?m[g++]=96|R:R<256?(A<2&&m.copyWithin(g+2,g+1,g+1+R),m[g++]=120,m[g++]=R):R<65536?(A<3&&m.copyWithin(g+3,g+2,g+2+R),m[g++]=121,m[g++]=R>>8,m[g++]=R&255):(A<5&&m.copyWithin(g+5,g+3,g+3+R),m[g++]=122,ce.setUint32(g,R),g+=4),g+=R}else if(U==="number")if(w>>>0===w)w<24?m[g++]=w:w<256?(m[g++]=24,m[g++]=w):w<65536?(m[g++]=25,m[g++]=w>>8,m[g++]=w&255):(m[g++]=26,ce.setUint32(g,w),g+=4);else if(w>>0===w)w>=-24?m[g++]=31-w:w>=-256?(m[g++]=56,m[g++]=~w):w>=-65536?(m[g++]=57,ce.setUint16(g,~w),g+=2):(m[g++]=58,ce.setUint32(g,~w),g+=4);else{let T;if((T=this.useFloat32)>0&&w<4294967296&&w>=-2147483648){m[g++]=250,ce.setFloat32(g,w);let A;if(T<4||(A=w*Kn[(m[g]&127)<<1|m[g+1]>>7])>>0===A){g+=4;return}else g--}m[g++]=251,ce.setFloat64(g,w),g+=8}else if(U==="object")if(!w)m[g++]=246;else{if(a){let A=a.get(w);if(A){if(m[g++]=216,m[g++]=29,m[g++]=25,!A.references){let K=a.idsToInsert||(a.idsToInsert=[]);A.references=[],K.push(A)}A.references.push(g-n),g+=2;return}else a.set(w,{offset:g-n})}let T=w.constructor;if(T===Object)me(w,!0);else if(T===Array){R=w.length,R<24?m[g++]=128|R:Ve(R);for(let A=0;A<R;A++)W(w[A])}else if(T===Map)if((this.mapsAsObjects?this.useTag259ForMaps!==!1:this.useTag259ForMaps)&&(m[g++]=217,m[g++]=1,m[g++]=3),R=w.size,R<24?m[g++]=160|R:R<256?(m[g++]=184,m[g++]=R):R<65536?(m[g++]=185,m[g++]=R>>8,m[g++]=R&255):(m[g++]=186,ce.setUint32(g,R),g+=4),c.keyMap)for(let[A,K]of w)W(c.encodeKey(A)),W(K);else for(let[A,K]of w)W(A),W(K);else{for(let A=0,K=Ln.length;A<K;A++){let X=Js[A];if(w instanceof X){let G=Ln[A],Y=G.tag;Y==null&&(Y=G.getTag&&G.getTag.call(this,w)),Y<24?m[g++]=192|Y:Y<256?(m[g++]=216,m[g++]=Y):Y<65536?(m[g++]=217,m[g++]=Y>>8,m[g++]=Y&255):Y>-1&&(m[g++]=218,ce.setUint32(g,Y),g+=4),G.encode.call(this,w,W,F);return}}if(w[Symbol.iterator]){if(xn){let A=new Error("Iterable should be serialized as iterator");throw A.iteratorNotHandled=!0,A}m[g++]=159;for(let A of w)W(A);m[g++]=255;return}if(w[Symbol.asyncIterator]||T===Sn){let A=new Error("Iterable/blob should be serialized as iterator");throw A.iteratorNotHandled=!0,A}me(w,!w.hasOwnProperty)}}else if(U==="boolean")m[g++]=w?245:244;else if(U==="bigint"){if(w<BigInt(1)<<BigInt(64)&&w>=0)m[g++]=27,ce.setBigUint64(g,w);else if(w>-(BigInt(1)<<BigInt(64))&&w<0)m[g++]=59,ce.setBigUint64(g,-w-BigInt(1));else if(this.largeBigIntToFloat)m[g++]=251,ce.setFloat64(g,Number(w));else throw new RangeError(w+" was too large to fit in CBOR 64-bit integer format, set largeBigIntToFloat to convert to float-64");g+=8}else if(U==="undefined")m[g++]=247;else throw new Error("Unknown type: "+U)},me=this.useRecords===!1?this.variableMapSize?w=>{let U=Object.keys(w),R=Object.values(w),T=U.length;if(T<24?m[g++]=160|T:T<256?(m[g++]=184,m[g++]=T):T<65536?(m[g++]=185,m[g++]=T>>8,m[g++]=T&255):(m[g++]=186,ce.setUint32(g,T),g+=4),c.keyMap)for(let A=0;A<T;A++)W(encodeKey(U[A])),W(R[A]);else for(let A=0;A<T;A++)W(U[A]),W(R[A])}:(w,U)=>{m[g++]=185;let R=g-n;g+=2;let T=0;if(c.keyMap)for(let A in w)(U||w.hasOwnProperty(A))&&(W(c.encodeKey(A)),W(w[A]),T++);else for(let A in w)(U||w.hasOwnProperty(A))&&(W(A),W(w[A]),T++);m[R+++n]=T>>8,m[R+n]=T&255}:(w,U)=>{let R,T=s.transitions||(s.transitions=Object.create(null)),A=0,K=0,X,G;if(this.keyMap){G=Object.keys(w).map(ee=>this.encodeKey(ee)),K=G.length;for(let ee=0;ee<K;ee++){let Dt=G[ee];R=T[Dt],R||(R=T[Dt]=Object.create(null),A++),T=R}}else for(let ee in w)(U||w.hasOwnProperty(ee))&&(R=T[ee],R||(T[ke]&1048576&&(X=T[ke]&65535),R=T[ee]=Object.create(null),A++),T=R,K++);let Y=T[ke];if(Y!==void 0)Y&=65535,m[g++]=217,m[g++]=Y>>8|224,m[g++]=Y&255;else if(G||(G=T.__keys__||(T.__keys__=Object.keys(w))),X===void 0?(Y=s.nextId++,Y||(Y=0,s.nextId=1),Y>=kr&&(s.nextId=(Y=_)+1)):Y=X,s[Y]=G,Y<_){m[g++]=217,m[g++]=Y>>8|224,m[g++]=Y&255,T=s.transitions;for(let ee=0;ee<K;ee++)(T[ke]===void 0||T[ke]&1048576)&&(T[ke]=Y),T=T[G[ee]];T[ke]=Y|1048576,o=!0}else{if(T[ke]=Y,ce.setUint32(g,3655335680),g+=3,A&&(oe+=te*A),j.length>=kr-_&&(j.shift()[ke]=void 0),j.push(T),Ve(K+2),W(57344+Y),W(G),U===null)return;for(let ee in w)(U||w.hasOwnProperty(ee))&&W(w[ee]);return}if(K<24?m[g++]=128|K:Ve(K),U!==null)for(let ee in w)(U||w.hasOwnProperty(ee))&&W(w[ee])},F=w=>{let U;if(w>16777216){if(w-n>Mr)throw new Error("Encoded buffer would be larger than maximum buffer size");U=Math.min(Mr,Math.round(Math.max((w-n)*(w>67108864?1.25:2),4194304)/4096)*4096)}else U=(Math.max(w-n<<2,m.length-1)>>12)+1<<12;let R=new vn(U);return ce=new DataView(R.buffer,0,U),m.copy?m.copy(R,0,n,w):R.set(m.slice(n,w)),g-=n,n=0,Qe=R.length-10,m=R};let J=100,q=1e3;this.encodeAsIterable=function(w,U){return Ce(w,U,Z)},this.encodeAsAsyncIterable=function(w,U){return Ce(w,U,Ae)};function*Z(w,U,R){let T=w.constructor;if(T===Object){let A=c.useRecords!==!1;A?me(w,null):Tr(Object.keys(w).length,160);for(let K in w){let X=w[K];A||W(K),X&&typeof X=="object"?U[K]?yield*Z(X,U[K]):yield*ue(X,U,K):W(X)}}else if(T===Array){Ve(w.length);for(let A=0;A<length;A++){let K=w[A];K&&(typeof K=="object"||g-n>J)?U.element?yield*Z(K,U.element):yield*ue(K,U,"element"):W(K)}}else if(w[Symbol.iterator]){m[g++]=159;for(let A of w)A&&(typeof A=="object"||g-n>J)?U.element?yield*Z(A,U.element):yield*ue(A,U,"element"):W(A);m[g++]=255}else T===Sn?(Tr(w.size,64),yield m.subarray(n,g),yield w,_e()):w[Symbol.asyncIterator]?(m[g++]=159,yield m.subarray(n,g),yield w,_e(),m[g++]=255):W(w);R&&g>n?yield m.subarray(n,g):g-n>J&&(yield m.subarray(n,g),_e())}function*ue(w,U,R){let T=g-n;try{W(w),g-n>J&&(yield m.subarray(n,g),_e())}catch(A){if(A.iteratorNotHandled)U[R]={},g=n+T,yield*Z.call(this,w,U[R]);else throw A}}function _e(){J=q,c.encode(null,En)}function Ce(w,U,R){return U&&U.chunkThreshold?J=q=U.chunkThreshold:J=100,w&&typeof w=="object"?(c.encode(null,En),R(w,c.iterateProperties||(c.iterateProperties={}),!0)):[c.encode(w)]}async function*Ae(w,U){for(let R of Z(w,U,!0)){let T=R.constructor;if(T===Or||T===Uint8Array)yield R;else if(T===Sn){let A=R.stream().getReader(),K;for(;!(K=await A.read()).done;)yield K.value}else if(R[Symbol.asyncIterator])for await(let A of R)_e(),A?yield*Ae(A,U.async||(U.async={})):yield c.encode(A);else yield R}}}useBuffer(e){m=e,ce=new DataView(m.buffer,m.byteOffset,m.byteLength),g=0}clearSharedData(){this.structures&&(this.structures=[]),this.sharedValues&&(this.sharedValues=void 0)}updateSharedData(){let e=this.sharedVersion||0;this.sharedVersion=e+1;let n=this.structures.slice(0),r=new qs(n,this.sharedValues,this.sharedVersion),o=this.saveShared(r,s=>(s&&s.version||0)==e);return o===!1?(r=this.getShared()||{},this.structures=r.structures||[],this.sharedValues=r.packedValues,this.sharedVersion=r.version,this.structures.nextId=this.structures.length):n.forEach((s,a)=>this.structures[a]=s),o}}function Tr(t,e){t<24?m[g++]=e|t:t<256?(m[g++]=e|24,m[g++]=t):t<65536?(m[g++]=e|25,m[g++]=t>>8,m[g++]=t&255):(m[g++]=e|26,ce.setUint32(g,t),g+=4)}class qs{constructor(e,n,r){this.structures=e,this.packedValues=n,this.version=r}}function Ve(t){t<24?m[g++]=128|t:t<256?(m[g++]=152,m[g++]=t):t<65536?(m[g++]=153,m[g++]=t>>8,m[g++]=t&255):(m[g++]=154,ce.setUint32(g,t),g+=4)}function Yt(t,e){switch(typeof t){case"string":if(t.length>3){if(e.objectMap[t]>-1||e.values.length>=e.maxValues)return;let r=e.get(t);if(r)++r.count==2&&e.values.push(t);else if(e.set(t,{count:1}),e.samplingPackedValues){let o=e.samplingPackedValues.get(t);o?o.count++:e.samplingPackedValues.set(t,{count:1})}}break;case"object":if(t)if(t instanceof Array)for(let r=0,o=t.length;r<o;r++)Yt(t[r],e);else{let r=!e.encoder.useRecords;for(var n in t)t.hasOwnProperty(n)&&(r&&Yt(n,e),Yt(t[n],e))}break;case"function":console.log(t)}}const Ff=new Uint8Array(new Uint16Array([1]).buffer)[0]==1;Js=[Date,Set,Error,RegExp,ot,ArrayBuffer,Uint8Array,Uint8ClampedArray,Uint16Array,Uint32Array,typeof BigUint64Array>"u"?function(){}:BigUint64Array,Int8Array,Int16Array,Int32Array,typeof BigInt64Array>"u"?function(){}:BigInt64Array,Float32Array,Float64Array,qs];Ln=[{tag:1,encode(t,e){let n=t.getTime()/1e3;(this.useTimestamp32||t.getMilliseconds()===0)&&n>=0&&n<4294967296?(m[g++]=26,ce.setUint32(g,n),g+=4):(m[g++]=251,ce.setFloat64(g,n),g+=8)}},{tag:258,encode(t,e){let n=Array.from(t);e(n)}},{tag:27,encode(t,e){e([t.name,t.message])}},{tag:27,encode(t,e){e(["RegExp",t.source,t.flags])}},{getTag(t){return t.tag},encode(t,e){e(t.value)}},{encode(t,e,n){Dr(t,n)}},{getTag(t){if(t.constructor===Uint8Array&&(this.tagUint8Array||Mt&&this.tagUint8Array!==!1))return 64},encode(t,e,n){Dr(t,n)}},ze(68,1),ze(69,2),ze(70,4),ze(71,8),ze(72,1),ze(77,2),ze(78,4),ze(79,8),ze(85,4),ze(86,8),{encode(t,e){let n=t.packedValues||[],r=t.structures||[];if(n.values.length>0){m[g++]=216,m[g++]=51,Ve(4);let o=n.values;e(o),Ve(0),Ve(0),packedObjectMap=Object.create(sharedPackedObjectMap||null);for(let s=0,a=o.length;s<a;s++)packedObjectMap[o[s]]=s}if(r){ce.setUint32(g,3655335424),g+=3;let o=r.slice(0);o.unshift(57344),o.push(new ot(t.version,1399353956)),e(o)}else e(new ot(t.version,1399353956))}}];function ze(t,e){return!Ff&&e>1&&(t-=4),{tag:t,encode:function(r,o){let s=r.byteLength,a=r.byteOffset||0,u=r.buffer||r;o(Mt?Buffer.from(u,a,s):new Uint8Array(u,a,s))}}}function Dr(t,e){let n=t.byteLength;n<24?m[g++]=64+n:n<256?(m[g++]=88,m[g++]=n):n<65536?(m[g++]=89,m[g++]=n>>8,m[g++]=n&255):(m[g++]=90,ce.setUint32(g,n),g+=4),g+n>=m.length&&e(g+n),m.set(t.buffer?t:new Uint8Array(t),g),g+=n}function Nf(t,e){let n,r=e.length*2,o=t.length-r;e.sort((s,a)=>s.offset>a.offset?1:-1);for(let s=0;s<e.length;s++){let a=e[s];a.id=s;for(let u of a.references)t[u++]=s>>8,t[u]=s&255}for(;n=e.pop();){let s=n.offset;t.copyWithin(s+r,s,o),r-=2;let a=s+r;t[a++]=216,t[a++]=28,o=s}return t}function jr(t,e){ce.setUint32(ye.position+t,g-ye.position-t+1);let n=ye;ye=null,e(n[0]),e(n[1])}let Jn=new Pf({useRecords:!1});const wt=Jn.encode;Jn.encodeAsIterable;Jn.encodeAsAsyncIterable;const Pr=512,Lf=1024,En=2048;class Uf extends Ye{broadcast(e,n){const r=wt(n);this.emit("message",{targetId:"*",channelId:"m/"+e,message:r,broadcast:!0})}receive(e,n,r){const o=Ys(r),s=n.slice(2);this.emit("data",{peerId:e,channelId:s,data:o})}}function $f(t){let e=0;t.forEach(o=>{e+=o.length});const n=new Uint8Array(e);let r=0;return t.forEach(o=>{n.set(o,r),r+=o.length}),n}class Bf{storageAdapter;constructor(e){this.storageAdapter=e}incrementalChanges={};saveIncremental(e,n){const r=ks(n).saveIncremental();r&&r.length>0&&(this.incrementalChanges[e]||(this.incrementalChanges[e]=0),this.storageAdapter.save(`${e}.incremental.${this.incrementalChanges[e]}`,r),this.incrementalChanges[e]++)}saveTotal(e,n){const r=Ds(n);this.storageAdapter.save(`${e}.snapshot`,r);for(let o=0;o<this.incrementalChanges[e];o++)this.storageAdapter.remove(`${e}.incremental.${o}`);this.incrementalChanges[e]=0}async load(e){const n=[];let r=await this.storageAdapter.load(`${e}.snapshot`);r&&r.length>0&&n.push(r);let o=0;for(;r=await this.storageAdapter.load(`${e}.incremental.${o}`);)r&&r.length>0&&n.push(r),o+=1;return $f(n)}shouldCompact(e){return this.incrementalChanges[e]>=20}save(e,n){this.shouldCompact(e)?this.saveTotal(e,n):this.saveIncremental(e,n)}}const Je=Be("DocSynchronizer"),Fr=Be("DocSynchronizer:Concise"),Bt=Be("DocSynchronizer:Ops");class zf extends Ye{handle;peers=[];syncStates={};constructor(e){super(),this.handle=e,e.on("change",()=>this.syncWithPeers())}getSyncState(e){if(!e)throw new Error("Tried to load a missing peerId");this.peers.includes(e)||(Je("adding a new peer",e),this.peers.push(e));let n=this.syncStates[e];return n||(n=zs()),n}setSyncState(e,n){this.syncStates[e]=n}async sendSyncMessage(e,n,r){Je(`[${this.handle.documentId}]->[${e}]: sendSyncMessage`);const o=this.getSyncState(e),[s,a]=$s(r,o);if(this.setSyncState(e,s),a){const u=kn(a);Je(`[${this.handle.documentId}]->[${e}]: sendSyncMessage: ${a.byteLength}b`,u),Fr(`${e} \u2B05\uFE0F\uFE0F  ${this.handle.documentId} (${a.byteLength} bytes)`),Bt.enabled&&Bt(u.changes.flatMap(h=>Qt(h).ops.map(_=>JSON.stringify(_))));const c=this.handle.documentId;this.emit("message",{targetId:e,channelId:c,message:a,broadcast:!1})}else Je(`[${this.handle.documentId}]->[${e}]: sendSyncMessage: [no message generated]`)}async beginSync(e){Je(`[${this.handle.documentId}]: beginSync: ${e}`);const{documentId:n}=this.handle,r=await this.handle.syncValue();this.setSyncState(e,Us(Ls(this.getSyncState(e)))),this.sendSyncMessage(e,n,r)}endSync(e){Je(`removing peer ${e}`),this.peers=this.peers.filter(n=>n!==e)}async onSyncMessage(e,n,r){if(n!==this.handle.documentId)throw new Error(`[DocHandle: ${this.handle.documentId}]: Received a sync message for ${n}`);this.handle.updateDoc(o=>{const s=kn(r);Je(`[${this.handle.documentId}]->[${e}]: receiveSync: ${r.byteLength}b`,s),Fr(`${e} \u27A1\uFE0F\uFE0F\uFE0F  ${this.handle.documentId} (${r.byteLength} bytes)`),Bt.enabled&&Bt(s.changes.flatMap(d=>Qt(d).ops.map(v=>JSON.stringify(v))));const a=Date.now(),[u,c]=Bs(o,this.getSyncState(e),r),_=Date.now()-a;return Je(`[${this.handle.documentId}]: receiveSync: <- ${e} ${r.byteLength}b in ${_}ms ${_>1e3?"[SLOW]!":""} from ${e}`),this.setSyncState(e,c),this.sendSyncMessage(e,this.handle.documentId,o),u})}async syncWithPeers(){Je(`[${this.handle.documentId}]: syncWithPeers`);const{documentId:e}=this.handle,n=await this.handle.syncValue();this.peers.forEach(r=>{this.sendSyncMessage(r,e,n)})}}const zt=Be("CollectionSynchronizer");class Vf extends Ye{repo;peers={};syncPool={};constructor(e){super(),this.repo=e}async onSyncMessage(e,n,r){const o=n,s=await this.fetchDocSynchronizer(o);zt(`onSyncMessage: ${e}, ${n}, ${r}`),s.onSyncMessage(e,n,r),this.__generousPeers().forEach(a=>{s.peers.includes(a)||s.beginSync(a)})}async fetchDocSynchronizer(e){if(!this.syncPool[e]){const n=await this.repo.find(e);this.syncPool[e]=this.syncPool[e]||this.initDocSynchronizer(n)}return this.syncPool[e]}initDocSynchronizer(e){const n=new zf(e);return n.on("message",r=>this.emit("message",r)),n}async addDocument(e){const n=await this.fetchDocSynchronizer(e);this.__generousPeers().forEach(r=>n.beginSync(r))}__generousPeers(){return Object.entries(this.peers).filter(([,e])=>e===!0).map(([e])=>e)}addPeer(e,n){zt(`${e}, ${n}`),this.peers[e]=n,n===!0&&(zt("sharing all open docs"),Object.values(this.syncPool).forEach(r=>r.beginSync(e)))}removePeer(e){zt(`removing peer ${e}`),delete this.peers[e];for(const n of Object.values(this.syncPool))n.endSync(e)}}class Wf extends pf{networkSubsystem;storageSubsystem;ephemeralData;constructor(e){super();const{storage:n,network:r,peerId:o,sharePolicy:s=()=>!0}=e;if(n){const h=new Bf(n);this.storageSubsystem=h,this.on("document",async({handle:_})=>{_.on("change",({handle:v})=>h.save(v.documentId,v.doc));const d=await h.load(_.documentId);d.byteLength>0?_.loadIncremental(d):_.unblockSync()})}else this.on("document",async({handle:h})=>{h.unblockSync()});const a=new mf(r,o);this.networkSubsystem=a;const u=new Vf(this),c=new Uf;this.ephemeralData=c,a.on("peer",({peerId:h})=>{u.addPeer(h,s(h))}),a.on("peer-disconnected",({peerId:h})=>{u.removePeer(h)}),this.on("document",({handle:h})=>{u.addDocument(h.documentId)}),a.on("message",h=>{const{senderId:_,channelId:d,message:v}=h;d.startsWith("m/")?c.receive(_,d,v):u.onSyncMessage(_,d,v)}),u.on("message",({targetId:h,channelId:_,message:d,broadcast:v})=>{a.sendMessage(h,_,d,v)}),c.on("message",({targetId:h,channelId:_,message:d,broadcast:v})=>{a.sendMessage(h,_,d,v)}),a.join("sync_channel")}}const Nr=Be("messagechannel");class Hf extends Ye{weakRef;isDisconnected=!1;constructor(e){super(),this.weakRef=new WeakRef(e),e.addEventListener("message",n=>{this.emit("message",n)})}postMessage(e,n){const r=this.weakRef.deref();if(!r){this.disconnnect();return}try{r.postMessage(e,n)}catch{this.disconnnect()}}start(){const e=this.weakRef.deref();if(!e){this.disconnnect();return}try{e.start()}catch{this.disconnnect()}}disconnnect(){this.isDisconnected||(this.emit("close"),this.isDisconnected=!0)}isAlive(){return this.isDisconnected?!1:this.weakRef.deref()?!0:(this.disconnnect(),!1)}}class Kf extends Ye{port;constructor(e){e.addEventListener("message",n=>{this.emit("message",n)}),super(),this.port=e}postMessage(e,n){this.port.postMessage(e,n)}start(){this.port.start()}isAlive(){return!0}}class Yf extends Ye{channels={};messagePortRef;peerId;constructor(e,n={}){super();const r=n.useWeakRef??!1;this.messagePortRef=r?new Hf(e):new Kf(e)}connect(e){Nr("messageport connecting"),this.peerId=e,this.messagePortRef.start(),this.messagePortRef.addListener("message",n=>{Nr("message port received",n.data);const{origin:r,destination:o,type:s,channelId:a,message:u,broadcast:c}=n.data;if(o&&!(o===this.peerId||c))throw new Error("MessagePortNetwork should never receive messages for a different peer.");switch(s){case"arrive":this.messagePortRef.postMessage({origin:this.peerId,destination:r,type:"welcome"}),this.announceConnection(a,r);break;case"welcome":this.announceConnection(a,r);break;case"message":this.emit("message",{senderId:r,targetId:o,channelId:a,message:new Uint8Array(u),broadcast:c});break;default:throw new Error("unhandled message from network")}}),this.messagePortRef.addListener("close",()=>{this.emit("close")})}sendMessage(e,n,r,o){const s=r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength);this.messagePortRef.postMessage({origin:this.peerId,destination:e,channelId:n,type:"message",message:s,broadcast:o},[s])}announceConnection(e,n){this.emit("peer-candidate",{peerId:n,channelId:e})}join(e){this.messagePortRef.postMessage({origin:this.peerId,channelId:e,type:"arrive"})}leave(e){throw new Error("Unimplemented: leave on MessagePortNetworkAdapter: "+e)}}function Vt(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Jt={exports:{}};(function(t,e){(function(n){t.exports=n()})(function(){return function n(r,o,s){function a(h,_){if(!o[h]){if(!r[h]){var d=typeof Vt=="function"&&Vt;if(!_&&d)return d(h,!0);if(u)return u(h,!0);var v=new Error("Cannot find module '"+h+"'");throw v.code="MODULE_NOT_FOUND",v}var L=o[h]={exports:{}};r[h][0].call(L.exports,function($){var H=r[h][1][$];return a(H||$)},L,L.exports,n,r,o,s)}return o[h].exports}for(var u=typeof Vt=="function"&&Vt,c=0;c<s.length;c++)a(s[c]);return a}({1:[function(n,r,o){(function(s){var a=s.MutationObserver||s.WebKitMutationObserver,u;if(a){var c=0,h=new a($),_=s.document.createTextNode("");h.observe(_,{characterData:!0}),u=function(){_.data=c=++c%2}}else if(!s.setImmediate&&typeof s.MessageChannel<"u"){var d=new s.MessageChannel;d.port1.onmessage=$,u=function(){d.port2.postMessage(0)}}else"document"in s&&"onreadystatechange"in s.document.createElement("script")?u=function(){var j=s.document.createElement("script");j.onreadystatechange=function(){$(),j.onreadystatechange=null,j.parentNode.removeChild(j),j=null},s.document.documentElement.appendChild(j)}:u=function(){setTimeout($,0)};var v,L=[];function $(){v=!0;for(var j,oe,te=L.length;te;){for(oe=L,L=[],j=-1;++j<te;)oe[j]();te=L.length}v=!1}r.exports=H;function H(j){L.push(j)===1&&!v&&u()}}).call(this,typeof Ft<"u"?Ft:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(n,r,o){var s=n(1);function a(){}var u={},c=["REJECTED"],h=["FULFILLED"],_=["PENDING"];r.exports=d;function d(F){if(typeof F!="function")throw new TypeError("resolver must be a function");this.state=_,this.queue=[],this.outcome=void 0,F!==a&&H(this,F)}d.prototype.catch=function(F){return this.then(null,F)},d.prototype.then=function(F,J){if(typeof F!="function"&&this.state===h||typeof J!="function"&&this.state===c)return this;var q=new this.constructor(a);if(this.state!==_){var Z=this.state===h?F:J;L(q,Z,this.outcome)}else this.queue.push(new v(q,F,J));return q};function v(F,J,q){this.promise=F,typeof J=="function"&&(this.onFulfilled=J,this.callFulfilled=this.otherCallFulfilled),typeof q=="function"&&(this.onRejected=q,this.callRejected=this.otherCallRejected)}v.prototype.callFulfilled=function(F){u.resolve(this.promise,F)},v.prototype.otherCallFulfilled=function(F){L(this.promise,this.onFulfilled,F)},v.prototype.callRejected=function(F){u.reject(this.promise,F)},v.prototype.otherCallRejected=function(F){L(this.promise,this.onRejected,F)};function L(F,J,q){s(function(){var Z;try{Z=J(q)}catch(ue){return u.reject(F,ue)}Z===F?u.reject(F,new TypeError("Cannot resolve promise with itself")):u.resolve(F,Z)})}u.resolve=function(F,J){var q=j($,J);if(q.status==="error")return u.reject(F,q.value);var Z=q.value;if(Z)H(F,Z);else{F.state=h,F.outcome=J;for(var ue=-1,_e=F.queue.length;++ue<_e;)F.queue[ue].callFulfilled(J)}return F},u.reject=function(F,J){F.state=c,F.outcome=J;for(var q=-1,Z=F.queue.length;++q<Z;)F.queue[q].callRejected(J);return F};function $(F){var J=F&&F.then;if(F&&(typeof F=="object"||typeof F=="function")&&typeof J=="function")return function(){J.apply(F,arguments)}}function H(F,J){var q=!1;function Z(Ae){q||(q=!0,u.reject(F,Ae))}function ue(Ae){q||(q=!0,u.resolve(F,Ae))}function _e(){J(ue,Z)}var Ce=j(_e);Ce.status==="error"&&Z(Ce.value)}function j(F,J){var q={};try{q.value=F(J),q.status="success"}catch(Z){q.status="error",q.value=Z}return q}d.resolve=oe;function oe(F){return F instanceof this?F:u.resolve(new this(a),F)}d.reject=te;function te(F){var J=new this(a);return u.reject(J,F)}d.all=W;function W(F){var J=this;if(Object.prototype.toString.call(F)!=="[object Array]")return this.reject(new TypeError("must be an array"));var q=F.length,Z=!1;if(!q)return this.resolve([]);for(var ue=new Array(q),_e=0,Ce=-1,Ae=new this(a);++Ce<q;)w(F[Ce],Ce);return Ae;function w(U,R){J.resolve(U).then(T,function(A){Z||(Z=!0,u.reject(Ae,A))});function T(A){ue[R]=A,++_e===q&&!Z&&(Z=!0,u.resolve(Ae,ue))}}}d.race=me;function me(F){var J=this;if(Object.prototype.toString.call(F)!=="[object Array]")return this.reject(new TypeError("must be an array"));var q=F.length,Z=!1;if(!q)return this.resolve([]);for(var ue=-1,_e=new this(a);++ue<q;)Ce(F[ue]);return _e;function Ce(Ae){J.resolve(Ae).then(function(w){Z||(Z=!0,u.resolve(_e,w))},function(w){Z||(Z=!0,u.reject(_e,w))})}}},{1:1}],3:[function(n,r,o){(function(s){typeof s.Promise!="function"&&(s.Promise=n(2))}).call(this,typeof Ft<"u"?Ft:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(n,r,o){var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i};function a(i,l){if(!(i instanceof l))throw new TypeError("Cannot call a class as a function")}function u(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var c=u();function h(){try{if(!c||!c.open)return!1;var i=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),l=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!i||l)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function _(i,l){i=i||[],l=l||{};try{return new Blob(i,l)}catch(y){if(y.name!=="TypeError")throw y;for(var f=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,b=new f,p=0;p<i.length;p+=1)b.append(i[p]);return b.getBlob(l.type)}}typeof Promise>"u"&&n(3);var d=Promise;function v(i,l){l&&i.then(function(f){l(null,f)},function(f){l(f)})}function L(i,l,f){typeof l=="function"&&i.then(l),typeof f=="function"&&i.catch(f)}function $(i){return typeof i!="string"&&(console.warn(i+" used as a key, but it is not a string."),i=String(i)),i}function H(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var j="local-forage-detect-blob-support",oe=void 0,te={},W=Object.prototype.toString,me="readonly",F="readwrite";function J(i){for(var l=i.length,f=new ArrayBuffer(l),b=new Uint8Array(f),p=0;p<l;p++)b[p]=i.charCodeAt(p);return f}function q(i){return new d(function(l){var f=i.transaction(j,F),b=_([""]);f.objectStore(j).put(b,"key"),f.onabort=function(p){p.preventDefault(),p.stopPropagation(),l(!1)},f.oncomplete=function(){var p=navigator.userAgent.match(/Chrome\/(\d+)/),y=navigator.userAgent.match(/Edge\//);l(y||!p||parseInt(p[1],10)>=43)}}).catch(function(){return!1})}function Z(i){return typeof oe=="boolean"?d.resolve(oe):q(i).then(function(l){return oe=l,oe})}function ue(i){var l=te[i.name],f={};f.promise=new d(function(b,p){f.resolve=b,f.reject=p}),l.deferredOperations.push(f),l.dbReady?l.dbReady=l.dbReady.then(function(){return f.promise}):l.dbReady=f.promise}function _e(i){var l=te[i.name],f=l.deferredOperations.pop();if(f)return f.resolve(),f.promise}function Ce(i,l){var f=te[i.name],b=f.deferredOperations.pop();if(b)return b.reject(l),b.promise}function Ae(i,l){return new d(function(f,b){if(te[i.name]=te[i.name]||ee(),i.db)if(l)ue(i),i.db.close();else return f(i.db);var p=[i.name];l&&p.push(i.version);var y=c.open.apply(c,p);l&&(y.onupgradeneeded=function(E){var I=y.result;try{I.createObjectStore(i.storeName),E.oldVersion<=1&&I.createObjectStore(j)}catch(k){if(k.name==="ConstraintError")console.warn('The database "'+i.name+'" has been upgraded from version '+E.oldVersion+" to version "+E.newVersion+', but the storage "'+i.storeName+'" already exists.');else throw k}}),y.onerror=function(E){E.preventDefault(),b(y.error)},y.onsuccess=function(){var E=y.result;E.onversionchange=function(I){I.target.close()},f(E),_e(i)}})}function w(i){return Ae(i,!1)}function U(i){return Ae(i,!0)}function R(i,l){if(!i.db)return!0;var f=!i.db.objectStoreNames.contains(i.storeName),b=i.version<i.db.version,p=i.version>i.db.version;if(b&&(i.version!==l&&console.warn('The database "'+i.name+`" can't be downgraded from version `+i.db.version+" to version "+i.version+"."),i.version=i.db.version),p||f){if(f){var y=i.db.version+1;y>i.version&&(i.version=y)}return!0}return!1}function T(i){return new d(function(l,f){var b=new FileReader;b.onerror=f,b.onloadend=function(p){var y=btoa(p.target.result||"");l({__local_forage_encoded_blob:!0,data:y,type:i.type})},b.readAsBinaryString(i)})}function A(i){var l=J(atob(i.data));return _([l],{type:i.type})}function K(i){return i&&i.__local_forage_encoded_blob}function X(i){var l=this,f=l._initReady().then(function(){var b=te[l._dbInfo.name];if(b&&b.dbReady)return b.dbReady});return L(f,i,i),f}function G(i){ue(i);for(var l=te[i.name],f=l.forages,b=0;b<f.length;b++){var p=f[b];p._dbInfo.db&&(p._dbInfo.db.close(),p._dbInfo.db=null)}return i.db=null,w(i).then(function(y){return i.db=y,R(i)?U(i):y}).then(function(y){i.db=l.db=y;for(var E=0;E<f.length;E++)f[E]._dbInfo.db=y}).catch(function(y){throw Ce(i,y),y})}function Y(i,l,f,b){b===void 0&&(b=1);try{var p=i.db.transaction(i.storeName,l);f(null,p)}catch(y){if(b>0&&(!i.db||y.name==="InvalidStateError"||y.name==="NotFoundError"))return d.resolve().then(function(){if(!i.db||y.name==="NotFoundError"&&!i.db.objectStoreNames.contains(i.storeName)&&i.version<=i.db.version)return i.db&&(i.version=i.db.version+1),U(i)}).then(function(){return G(i).then(function(){Y(i,l,f,b-1)})}).catch(f);f(y)}}function ee(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function Dt(i){var l=this,f={db:null};if(i)for(var b in i)f[b]=i[b];var p=te[f.name];p||(p=ee(),te[f.name]=p),p.forages.push(l),l._initReady||(l._initReady=l.ready,l.ready=X);var y=[];function E(){return d.resolve()}for(var I=0;I<p.forages.length;I++){var k=p.forages[I];k!==l&&y.push(k._initReady().catch(E))}var M=p.forages.slice(0);return d.all(y).then(function(){return f.db=p.db,w(f)}).then(function(P){return f.db=P,R(f,l._defaultConfig.version)?U(f):P}).then(function(P){f.db=p.db=P,l._dbInfo=f;for(var V=0;V<M.length;V++){var Q=M[V];Q!==l&&(Q._dbInfo.db=f.db,Q._dbInfo.version=f.version)}})}function ri(i,l){var f=this;i=$(i);var b=new d(function(p,y){f.ready().then(function(){Y(f._dbInfo,me,function(E,I){if(E)return y(E);try{var k=I.objectStore(f._dbInfo.storeName),M=k.get(i);M.onsuccess=function(){var P=M.result;P===void 0&&(P=null),K(P)&&(P=A(P)),p(P)},M.onerror=function(){y(M.error)}}catch(P){y(P)}})}).catch(y)});return v(b,l),b}function oi(i,l){var f=this,b=new d(function(p,y){f.ready().then(function(){Y(f._dbInfo,me,function(E,I){if(E)return y(E);try{var k=I.objectStore(f._dbInfo.storeName),M=k.openCursor(),P=1;M.onsuccess=function(){var V=M.result;if(V){var Q=V.value;K(Q)&&(Q=A(Q));var ie=i(Q,V.key,P++);ie!==void 0?p(ie):V.continue()}else p()},M.onerror=function(){y(M.error)}}catch(V){y(V)}})}).catch(y)});return v(b,l),b}function si(i,l,f){var b=this;i=$(i);var p=new d(function(y,E){var I;b.ready().then(function(){return I=b._dbInfo,W.call(l)==="[object Blob]"?Z(I.db).then(function(k){return k?l:T(l)}):l}).then(function(k){Y(b._dbInfo,F,function(M,P){if(M)return E(M);try{var V=P.objectStore(b._dbInfo.storeName);k===null&&(k=void 0);var Q=V.put(k,i);P.oncomplete=function(){k===void 0&&(k=null),y(k)},P.onabort=P.onerror=function(){var ie=Q.error?Q.error:Q.transaction.error;E(ie)}}catch(ie){E(ie)}})}).catch(E)});return v(p,f),p}function ii(i,l){var f=this;i=$(i);var b=new d(function(p,y){f.ready().then(function(){Y(f._dbInfo,F,function(E,I){if(E)return y(E);try{var k=I.objectStore(f._dbInfo.storeName),M=k.delete(i);I.oncomplete=function(){p()},I.onerror=function(){y(M.error)},I.onabort=function(){var P=M.error?M.error:M.transaction.error;y(P)}}catch(P){y(P)}})}).catch(y)});return v(b,l),b}function ai(i){var l=this,f=new d(function(b,p){l.ready().then(function(){Y(l._dbInfo,F,function(y,E){if(y)return p(y);try{var I=E.objectStore(l._dbInfo.storeName),k=I.clear();E.oncomplete=function(){b()},E.onabort=E.onerror=function(){var M=k.error?k.error:k.transaction.error;p(M)}}catch(M){p(M)}})}).catch(p)});return v(f,i),f}function ci(i){var l=this,f=new d(function(b,p){l.ready().then(function(){Y(l._dbInfo,me,function(y,E){if(y)return p(y);try{var I=E.objectStore(l._dbInfo.storeName),k=I.count();k.onsuccess=function(){b(k.result)},k.onerror=function(){p(k.error)}}catch(M){p(M)}})}).catch(p)});return v(f,i),f}function fi(i,l){var f=this,b=new d(function(p,y){if(i<0){p(null);return}f.ready().then(function(){Y(f._dbInfo,me,function(E,I){if(E)return y(E);try{var k=I.objectStore(f._dbInfo.storeName),M=!1,P=k.openKeyCursor();P.onsuccess=function(){var V=P.result;if(!V){p(null);return}i===0||M?p(V.key):(M=!0,V.advance(i))},P.onerror=function(){y(P.error)}}catch(V){y(V)}})}).catch(y)});return v(b,l),b}function ui(i){var l=this,f=new d(function(b,p){l.ready().then(function(){Y(l._dbInfo,me,function(y,E){if(y)return p(y);try{var I=E.objectStore(l._dbInfo.storeName),k=I.openKeyCursor(),M=[];k.onsuccess=function(){var P=k.result;if(!P){b(M);return}M.push(P.key),P.continue()},k.onerror=function(){p(k.error)}}catch(P){p(P)}})}).catch(p)});return v(f,i),f}function li(i,l){l=H.apply(this,arguments);var f=this.config();i=typeof i!="function"&&i||{},i.name||(i.name=i.name||f.name,i.storeName=i.storeName||f.storeName);var b=this,p;if(!i.name)p=d.reject("Invalid arguments");else{var y=i.name===f.name&&b._dbInfo.db,E=y?d.resolve(b._dbInfo.db):w(i).then(function(I){var k=te[i.name],M=k.forages;k.db=I;for(var P=0;P<M.length;P++)M[P]._dbInfo.db=I;return I});i.storeName?p=E.then(function(I){if(!!I.objectStoreNames.contains(i.storeName)){var k=I.version+1;ue(i);var M=te[i.name],P=M.forages;I.close();for(var V=0;V<P.length;V++){var Q=P[V];Q._dbInfo.db=null,Q._dbInfo.version=k}var ie=new d(function(ae,he){var de=c.open(i.name,k);de.onerror=function(Te){var yt=de.result;yt.close(),he(Te)},de.onupgradeneeded=function(){var Te=de.result;Te.deleteObjectStore(i.storeName)},de.onsuccess=function(){var Te=de.result;Te.close(),ae(Te)}});return ie.then(function(ae){M.db=ae;for(var he=0;he<P.length;he++){var de=P[he];de._dbInfo.db=ae,_e(de._dbInfo)}}).catch(function(ae){throw(Ce(i,ae)||d.resolve()).catch(function(){}),ae})}}):p=E.then(function(I){ue(i);var k=te[i.name],M=k.forages;I.close();for(var P=0;P<M.length;P++){var V=M[P];V._dbInfo.db=null}var Q=new d(function(ie,ae){var he=c.deleteDatabase(i.name);he.onerror=function(){var de=he.result;de&&de.close(),ae(he.error)},he.onblocked=function(){console.warn('dropInstance blocked for database "'+i.name+'" until all open connections are closed')},he.onsuccess=function(){var de=he.result;de&&de.close(),ie(de)}});return Q.then(function(ie){k.db=ie;for(var ae=0;ae<M.length;ae++){var he=M[ae];_e(he._dbInfo)}}).catch(function(ie){throw(Ce(i,ie)||d.resolve()).catch(function(){}),ie})})}return v(p,l),p}var di={_driver:"asyncStorage",_initStorage:Dt,_support:h(),iterate:oi,getItem:ri,setItem:si,removeItem:ii,clear:ai,length:ci,key:fi,keys:ui,dropInstance:li};function hi(){return typeof openDatabase=="function"}var Ge="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",gi="~~local_forage_type~",Zn=/^~~local_forage_type~([^~]+)~/,jt="__lfsc__:",sn=jt.length,an="arbf",cn="blob",er="si08",tr="ui08",nr="uic8",rr="si16",or="si32",sr="ur16",ir="ui32",ar="fl32",cr="fl64",fr=sn+an.length,ur=Object.prototype.toString;function lr(i){var l=i.length*.75,f=i.length,b,p=0,y,E,I,k;i[i.length-1]==="="&&(l--,i[i.length-2]==="="&&l--);var M=new ArrayBuffer(l),P=new Uint8Array(M);for(b=0;b<f;b+=4)y=Ge.indexOf(i[b]),E=Ge.indexOf(i[b+1]),I=Ge.indexOf(i[b+2]),k=Ge.indexOf(i[b+3]),P[p++]=y<<2|E>>4,P[p++]=(E&15)<<4|I>>2,P[p++]=(I&3)<<6|k&63;return M}function fn(i){var l=new Uint8Array(i),f="",b;for(b=0;b<l.length;b+=3)f+=Ge[l[b]>>2],f+=Ge[(l[b]&3)<<4|l[b+1]>>4],f+=Ge[(l[b+1]&15)<<2|l[b+2]>>6],f+=Ge[l[b+2]&63];return l.length%3===2?f=f.substring(0,f.length-1)+"=":l.length%3===1&&(f=f.substring(0,f.length-2)+"=="),f}function _i(i,l){var f="";if(i&&(f=ur.call(i)),i&&(f==="[object ArrayBuffer]"||i.buffer&&ur.call(i.buffer)==="[object ArrayBuffer]")){var b,p=jt;i instanceof ArrayBuffer?(b=i,p+=an):(b=i.buffer,f==="[object Int8Array]"?p+=er:f==="[object Uint8Array]"?p+=tr:f==="[object Uint8ClampedArray]"?p+=nr:f==="[object Int16Array]"?p+=rr:f==="[object Uint16Array]"?p+=sr:f==="[object Int32Array]"?p+=or:f==="[object Uint32Array]"?p+=ir:f==="[object Float32Array]"?p+=ar:f==="[object Float64Array]"?p+=cr:l(new Error("Failed to get type for BinaryArray"))),l(p+fn(b))}else if(f==="[object Blob]"){var y=new FileReader;y.onload=function(){var E=gi+i.type+"~"+fn(this.result);l(jt+cn+E)},y.readAsArrayBuffer(i)}else try{l(JSON.stringify(i))}catch(E){console.error("Couldn't convert value into a JSON string: ",i),l(null,E)}}function yi(i){if(i.substring(0,sn)!==jt)return JSON.parse(i);var l=i.substring(fr),f=i.substring(sn,fr),b;if(f===cn&&Zn.test(l)){var p=l.match(Zn);b=p[1],l=l.substring(p[0].length)}var y=lr(l);switch(f){case an:return y;case cn:return _([y],{type:b});case er:return new Int8Array(y);case tr:return new Uint8Array(y);case nr:return new Uint8ClampedArray(y);case rr:return new Int16Array(y);case sr:return new Uint16Array(y);case or:return new Int32Array(y);case ir:return new Uint32Array(y);case ar:return new Float32Array(y);case cr:return new Float64Array(y);default:throw new Error("Unkown type: "+f)}}var un={serialize:_i,deserialize:yi,stringToBuffer:lr,bufferToString:fn};function dr(i,l,f,b){i.executeSql("CREATE TABLE IF NOT EXISTS "+l.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],f,b)}function bi(i){var l=this,f={db:null};if(i)for(var b in i)f[b]=typeof i[b]!="string"?i[b].toString():i[b];var p=new d(function(y,E){try{f.db=openDatabase(f.name,String(f.version),f.description,f.size)}catch(I){return E(I)}f.db.transaction(function(I){dr(I,f,function(){l._dbInfo=f,y()},function(k,M){E(M)})},E)});return f.serializer=un,p}function Xe(i,l,f,b,p,y){i.executeSql(f,b,p,function(E,I){I.code===I.SYNTAX_ERR?E.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[l.storeName],function(k,M){M.rows.length?y(k,I):dr(k,l,function(){k.executeSql(f,b,p,y)},y)},y):y(E,I)},y)}function pi(i,l){var f=this;i=$(i);var b=new d(function(p,y){f.ready().then(function(){var E=f._dbInfo;E.db.transaction(function(I){Xe(I,E,"SELECT * FROM "+E.storeName+" WHERE key = ? LIMIT 1",[i],function(k,M){var P=M.rows.length?M.rows.item(0).value:null;P&&(P=E.serializer.deserialize(P)),p(P)},function(k,M){y(M)})})}).catch(y)});return v(b,l),b}function mi(i,l){var f=this,b=new d(function(p,y){f.ready().then(function(){var E=f._dbInfo;E.db.transaction(function(I){Xe(I,E,"SELECT * FROM "+E.storeName,[],function(k,M){for(var P=M.rows,V=P.length,Q=0;Q<V;Q++){var ie=P.item(Q),ae=ie.value;if(ae&&(ae=E.serializer.deserialize(ae)),ae=i(ae,ie.key,Q+1),ae!==void 0){p(ae);return}}p()},function(k,M){y(M)})})}).catch(y)});return v(b,l),b}function hr(i,l,f,b){var p=this;i=$(i);var y=new d(function(E,I){p.ready().then(function(){l===void 0&&(l=null);var k=l,M=p._dbInfo;M.serializer.serialize(l,function(P,V){V?I(V):M.db.transaction(function(Q){Xe(Q,M,"INSERT OR REPLACE INTO "+M.storeName+" (key, value) VALUES (?, ?)",[i,P],function(){E(k)},function(ie,ae){I(ae)})},function(Q){if(Q.code===Q.QUOTA_ERR){if(b>0){E(hr.apply(p,[i,k,f,b-1]));return}I(Q)}})})}).catch(I)});return v(y,f),y}function wi(i,l,f){return hr.apply(this,[i,l,f,1])}function vi(i,l){var f=this;i=$(i);var b=new d(function(p,y){f.ready().then(function(){var E=f._dbInfo;E.db.transaction(function(I){Xe(I,E,"DELETE FROM "+E.storeName+" WHERE key = ?",[i],function(){p()},function(k,M){y(M)})})}).catch(y)});return v(b,l),b}function Si(i){var l=this,f=new d(function(b,p){l.ready().then(function(){var y=l._dbInfo;y.db.transaction(function(E){Xe(E,y,"DELETE FROM "+y.storeName,[],function(){b()},function(I,k){p(k)})})}).catch(p)});return v(f,i),f}function xi(i){var l=this,f=new d(function(b,p){l.ready().then(function(){var y=l._dbInfo;y.db.transaction(function(E){Xe(E,y,"SELECT COUNT(key) as c FROM "+y.storeName,[],function(I,k){var M=k.rows.item(0).c;b(M)},function(I,k){p(k)})})}).catch(p)});return v(f,i),f}function Ei(i,l){var f=this,b=new d(function(p,y){f.ready().then(function(){var E=f._dbInfo;E.db.transaction(function(I){Xe(I,E,"SELECT key FROM "+E.storeName+" WHERE id = ? LIMIT 1",[i+1],function(k,M){var P=M.rows.length?M.rows.item(0).key:null;p(P)},function(k,M){y(M)})})}).catch(y)});return v(b,l),b}function Ci(i){var l=this,f=new d(function(b,p){l.ready().then(function(){var y=l._dbInfo;y.db.transaction(function(E){Xe(E,y,"SELECT key FROM "+y.storeName,[],function(I,k){for(var M=[],P=0;P<k.rows.length;P++)M.push(k.rows.item(P).key);b(M)},function(I,k){p(k)})})}).catch(p)});return v(f,i),f}function Ai(i){return new d(function(l,f){i.transaction(function(b){b.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(p,y){for(var E=[],I=0;I<y.rows.length;I++)E.push(y.rows.item(I).name);l({db:i,storeNames:E})},function(p,y){f(y)})},function(b){f(b)})})}function Ii(i,l){l=H.apply(this,arguments);var f=this.config();i=typeof i!="function"&&i||{},i.name||(i.name=i.name||f.name,i.storeName=i.storeName||f.storeName);var b=this,p;return i.name?p=new d(function(y){var E;i.name===f.name?E=b._dbInfo.db:E=openDatabase(i.name,"","",0),i.storeName?y({db:E,storeNames:[i.storeName]}):y(Ai(E))}).then(function(y){return new d(function(E,I){y.db.transaction(function(k){function M(ie){return new d(function(ae,he){k.executeSql("DROP TABLE IF EXISTS "+ie,[],function(){ae()},function(de,Te){he(Te)})})}for(var P=[],V=0,Q=y.storeNames.length;V<Q;V++)P.push(M(y.storeNames[V]));d.all(P).then(function(){E()}).catch(function(ie){I(ie)})},function(k){I(k)})})}):p=d.reject("Invalid arguments"),v(p,l),p}var Ri={_driver:"webSQLStorage",_initStorage:bi,_support:hi(),iterate:mi,getItem:pi,setItem:wi,removeItem:vi,clear:Si,length:xi,key:Ei,keys:Ci,dropInstance:Ii};function Oi(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function gr(i,l){var f=i.name+"/";return i.storeName!==l.storeName&&(f+=i.storeName+"/"),f}function ki(){var i="_localforage_support_test";try{return localStorage.setItem(i,!0),localStorage.removeItem(i),!1}catch{return!0}}function Mi(){return!ki()||localStorage.length>0}function Ti(i){var l=this,f={};if(i)for(var b in i)f[b]=i[b];return f.keyPrefix=gr(i,l._defaultConfig),Mi()?(l._dbInfo=f,f.serializer=un,d.resolve()):d.reject()}function Di(i){var l=this,f=l.ready().then(function(){for(var b=l._dbInfo.keyPrefix,p=localStorage.length-1;p>=0;p--){var y=localStorage.key(p);y.indexOf(b)===0&&localStorage.removeItem(y)}});return v(f,i),f}function ji(i,l){var f=this;i=$(i);var b=f.ready().then(function(){var p=f._dbInfo,y=localStorage.getItem(p.keyPrefix+i);return y&&(y=p.serializer.deserialize(y)),y});return v(b,l),b}function Pi(i,l){var f=this,b=f.ready().then(function(){for(var p=f._dbInfo,y=p.keyPrefix,E=y.length,I=localStorage.length,k=1,M=0;M<I;M++){var P=localStorage.key(M);if(P.indexOf(y)===0){var V=localStorage.getItem(P);if(V&&(V=p.serializer.deserialize(V)),V=i(V,P.substring(E),k++),V!==void 0)return V}}});return v(b,l),b}function Fi(i,l){var f=this,b=f.ready().then(function(){var p=f._dbInfo,y;try{y=localStorage.key(i)}catch{y=null}return y&&(y=y.substring(p.keyPrefix.length)),y});return v(b,l),b}function Ni(i){var l=this,f=l.ready().then(function(){for(var b=l._dbInfo,p=localStorage.length,y=[],E=0;E<p;E++){var I=localStorage.key(E);I.indexOf(b.keyPrefix)===0&&y.push(I.substring(b.keyPrefix.length))}return y});return v(f,i),f}function Li(i){var l=this,f=l.keys().then(function(b){return b.length});return v(f,i),f}function Ui(i,l){var f=this;i=$(i);var b=f.ready().then(function(){var p=f._dbInfo;localStorage.removeItem(p.keyPrefix+i)});return v(b,l),b}function $i(i,l,f){var b=this;i=$(i);var p=b.ready().then(function(){l===void 0&&(l=null);var y=l;return new d(function(E,I){var k=b._dbInfo;k.serializer.serialize(l,function(M,P){if(P)I(P);else try{localStorage.setItem(k.keyPrefix+i,M),E(y)}catch(V){(V.name==="QuotaExceededError"||V.name==="NS_ERROR_DOM_QUOTA_REACHED")&&I(V),I(V)}})})});return v(p,f),p}function Bi(i,l){if(l=H.apply(this,arguments),i=typeof i!="function"&&i||{},!i.name){var f=this.config();i.name=i.name||f.name,i.storeName=i.storeName||f.storeName}var b=this,p;return i.name?p=new d(function(y){i.storeName?y(gr(i,b._defaultConfig)):y(i.name+"/")}).then(function(y){for(var E=localStorage.length-1;E>=0;E--){var I=localStorage.key(E);I.indexOf(y)===0&&localStorage.removeItem(I)}}):p=d.reject("Invalid arguments"),v(p,l),p}var zi={_driver:"localStorageWrapper",_initStorage:Ti,_support:Oi(),iterate:Pi,getItem:ji,setItem:$i,removeItem:Ui,clear:Di,length:Li,key:Fi,keys:Ni,dropInstance:Bi},Vi=function(l,f){return l===f||typeof l=="number"&&typeof f=="number"&&isNaN(l)&&isNaN(f)},Wi=function(l,f){for(var b=l.length,p=0;p<b;){if(Vi(l[p],f))return!0;p++}return!1},_r=Array.isArray||function(i){return Object.prototype.toString.call(i)==="[object Array]"},_t={},yr={},st={INDEXEDDB:di,WEBSQL:Ri,LOCALSTORAGE:zi},Hi=[st.INDEXEDDB._driver,st.WEBSQL._driver,st.LOCALSTORAGE._driver],Pt=["dropInstance"],ln=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Pt),Ki={description:"",driver:Hi.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function Yi(i,l){i[l]=function(){var f=arguments;return i.ready().then(function(){return i[l].apply(i,f)})}}function dn(){for(var i=1;i<arguments.length;i++){var l=arguments[i];if(l)for(var f in l)l.hasOwnProperty(f)&&(_r(l[f])?arguments[0][f]=l[f].slice():arguments[0][f]=l[f])}return arguments[0]}var Ji=function(){function i(l){a(this,i);for(var f in st)if(st.hasOwnProperty(f)){var b=st[f],p=b._driver;this[f]=p,_t[p]||this.defineDriver(b)}this._defaultConfig=dn({},Ki),this._config=dn({},this._defaultConfig,l),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return i.prototype.config=function(f){if((typeof f>"u"?"undefined":s(f))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var b in f){if(b==="storeName"&&(f[b]=f[b].replace(/\W/g,"_")),b==="version"&&typeof f[b]!="number")return new Error("Database version must be a number.");this._config[b]=f[b]}return"driver"in f&&f.driver?this.setDriver(this._config.driver):!0}else return typeof f=="string"?this._config[f]:this._config},i.prototype.defineDriver=function(f,b,p){var y=new d(function(E,I){try{var k=f._driver,M=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!f._driver){I(M);return}for(var P=ln.concat("_initStorage"),V=0,Q=P.length;V<Q;V++){var ie=P[V],ae=!Wi(Pt,ie);if((ae||f[ie])&&typeof f[ie]!="function"){I(M);return}}var he=function(){for(var yt=function(Xi){return function(){var Qi=new Error("Method "+Xi+" is not implemented by the current driver"),br=d.reject(Qi);return v(br,arguments[arguments.length-1]),br}},hn=0,Gi=Pt.length;hn<Gi;hn++){var gn=Pt[hn];f[gn]||(f[gn]=yt(gn))}};he();var de=function(yt){_t[k]&&console.info("Redefining LocalForage driver: "+k),_t[k]=f,yr[k]=yt,E()};"_support"in f?f._support&&typeof f._support=="function"?f._support().then(de,I):de(!!f._support):de(!0)}catch(Te){I(Te)}});return L(y,b,p),y},i.prototype.driver=function(){return this._driver||null},i.prototype.getDriver=function(f,b,p){var y=_t[f]?d.resolve(_t[f]):d.reject(new Error("Driver not found."));return L(y,b,p),y},i.prototype.getSerializer=function(f){var b=d.resolve(un);return L(b,f),b},i.prototype.ready=function(f){var b=this,p=b._driverSet.then(function(){return b._ready===null&&(b._ready=b._initDriver()),b._ready});return L(p,f,f),p},i.prototype.setDriver=function(f,b,p){var y=this;_r(f)||(f=[f]);var E=this._getSupportedDrivers(f);function I(){y._config.driver=y.driver()}function k(V){return y._extend(V),I(),y._ready=y._initStorage(y._config),y._ready}function M(V){return function(){var Q=0;function ie(){for(;Q<V.length;){var ae=V[Q];return Q++,y._dbInfo=null,y._ready=null,y.getDriver(ae).then(k).catch(ie)}I();var he=new Error("No available storage method found.");return y._driverSet=d.reject(he),y._driverSet}return ie()}}var P=this._driverSet!==null?this._driverSet.catch(function(){return d.resolve()}):d.resolve();return this._driverSet=P.then(function(){var V=E[0];return y._dbInfo=null,y._ready=null,y.getDriver(V).then(function(Q){y._driver=Q._driver,I(),y._wrapLibraryMethodsWithReady(),y._initDriver=M(E)})}).catch(function(){I();var V=new Error("No available storage method found.");return y._driverSet=d.reject(V),y._driverSet}),L(this._driverSet,b,p),this._driverSet},i.prototype.supports=function(f){return!!yr[f]},i.prototype._extend=function(f){dn(this,f)},i.prototype._getSupportedDrivers=function(f){for(var b=[],p=0,y=f.length;p<y;p++){var E=f[p];this.supports(E)&&b.push(E)}return b},i.prototype._wrapLibraryMethodsWithReady=function(){for(var f=0,b=ln.length;f<b;f++)Yi(this,ln[f])},i.prototype.createInstance=function(f){return new i(f)},i}(),qi=new Ji;r.exports=qi},{3:3}]},{},[4])(4)})})(Jt);class Jf{load(e){return Jt.exports.getItem(e)}save(e,n){Jt.exports.setItem(e,n)}remove(e){Jt.exports.removeItem(e)}}var ct=null;typeof WebSocket<"u"?ct=WebSocket:typeof MozWebSocket<"u"?ct=MozWebSocket:typeof global<"u"?ct=global.WebSocket||global.MozWebSocket:typeof window<"u"?ct=window.WebSocket||window.MozWebSocket:typeof self<"u"&&(ct=self.WebSocket||self.MozWebSocket);var Cn=ct;const An=Be("WebsocketClient");class qf extends Ye{socket;timerId;peerId;url;channels=[];constructor(e){super(),this.url=e}connect(e){this.timerId||(this.timerId=setInterval(()=>this.connect(e),5e3)),this.peerId=e,this.socket=new Cn(this.url),this.socket.binaryType="arraybuffer",this.socket.addEventListener("open",()=>{An(`@ ${this.url}: open`),clearInterval(this.timerId),this.timerId=void 0,this.channels.forEach(n=>this.join(n))}),this.socket.addEventListener("close",()=>{An(`${this.url}: close`),this.timerId||this.connect(e)}),this.socket.addEventListener("message",n=>this.receiveMessage(n.data))}join(e){if(this.channels.includes(e)||this.channels.push(e),!this.socket)throw new Error("WTF, get a socket");this.socket.readyState===Cn.OPEN?this.socket.send(wt({type:"join",channelId:e,senderId:this.peerId})):this.socket.addEventListener("open",()=>{if(!this.socket)throw new Error("WTF, get a socket");this.socket.send(wt({type:"join",channelId:e,senderId:this.peerId}))},{once:!0})}leave(e){if(this.channels=this.channels.filter(n=>n!==e),!this.socket)throw new Error("WTF, get a socket");this.socket.send(wt({type:"leave",channelId:e,senderId:this.peerId}))}sendMessage(e,n,r,o){if(r.byteLength===0)throw new Error("tried to send a zero-length message");if(!this.peerId)throw new Error("Why don't we have a PeerID?");const s={senderId:this.peerId,targetId:e,channelId:n,type:"message",data:r,broadcast:o},a=wt(s),u=a.buffer.slice(a.byteOffset,a.byteOffset+a.byteLength);if(!this.socket||this.socket.readyState!==Cn.OPEN)throw new Error("Websocket Socket not ready!");this.socket.send(u)}announceConnection(e,n){if(!this.peerId)throw new Error("we should have a peer ID by now");this.emit("peer-candidate",{peerId:n,channelId:e})}receiveMessage(e){const n=Ys(new Uint8Array(e)),{type:r,senderId:o,targetId:s,channelId:a,data:u,broadcast:c}=n;if(!this.socket)throw new Error("Missing socket at receiveMessage");if(e.byteLength===0)throw new Error("received a zero-length message");switch(r){case"peer":An(`peer: ${o}, ${a}`),this.announceConnection(a,o);break;default:this.emit("message",{channelId:a,senderId:o,targetId:s,message:new Uint8Array(u),broadcast:c})}}}Be("WebsocketServer");var Gf={exports:{}},ne={};var Tt=Symbol.for("react.element"),Xf=Symbol.for("react.portal"),Qf=Symbol.for("react.fragment"),Zf=Symbol.for("react.strict_mode"),eu=Symbol.for("react.profiler"),tu=Symbol.for("react.provider"),nu=Symbol.for("react.context"),ru=Symbol.for("react.forward_ref"),ou=Symbol.for("react.suspense"),su=Symbol.for("react.memo"),iu=Symbol.for("react.lazy"),Lr=Symbol.iterator;function au(t){return t===null||typeof t!="object"?null:(t=Lr&&t[Lr]||t["@@iterator"],typeof t=="function"?t:null)}var Gs={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Xs=Object.assign,Qs={};function gt(t,e,n){this.props=t,this.context=e,this.refs=Qs,this.updater=n||Gs}gt.prototype.isReactComponent={};gt.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};gt.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Zs(){}Zs.prototype=gt.prototype;function qn(t,e,n){this.props=t,this.context=e,this.refs=Qs,this.updater=n||Gs}var Gn=qn.prototype=new Zs;Gn.constructor=qn;Xs(Gn,gt.prototype);Gn.isPureReactComponent=!0;var Ur=Array.isArray,ei=Object.prototype.hasOwnProperty,Xn={current:null},ti={key:!0,ref:!0,__self:!0,__source:!0};function ni(t,e,n){var r,o={},s=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)ei.call(e,r)&&!ti.hasOwnProperty(r)&&(o[r]=e[r]);var u=arguments.length-2;if(u===1)o.children=n;else if(1<u){for(var c=Array(u),h=0;h<u;h++)c[h]=arguments[h+2];o.children=c}if(t&&t.defaultProps)for(r in u=t.defaultProps,u)o[r]===void 0&&(o[r]=u[r]);return{$$typeof:Tt,type:t,key:s,ref:a,props:o,_owner:Xn.current}}function cu(t,e){return{$$typeof:Tt,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Qn(t){return typeof t=="object"&&t!==null&&t.$$typeof===Tt}function fu(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var $r=/\/+/g;function In(t,e){return typeof t=="object"&&t!==null&&t.key!=null?fu(""+t.key):e.toString(36)}function qt(t,e,n,r,o){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case Tt:case Xf:a=!0}}if(a)return a=t,o=o(a),t=r===""?"."+In(a,0):r,Ur(o)?(n="",t!=null&&(n=t.replace($r,"$&/")+"/"),qt(o,e,n,"",function(h){return h})):o!=null&&(Qn(o)&&(o=cu(o,n+(!o.key||a&&a.key===o.key?"":(""+o.key).replace($r,"$&/")+"/")+t)),e.push(o)),1;if(a=0,r=r===""?".":r+":",Ur(t))for(var u=0;u<t.length;u++){s=t[u];var c=r+In(s,u);a+=qt(s,e,n,c,o)}else if(c=au(t),typeof c=="function")for(t=c.call(t),u=0;!(s=t.next()).done;)s=s.value,c=r+In(s,u++),a+=qt(s,e,n,c,o);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Wt(t,e,n){if(t==null)return t;var r=[],o=0;return qt(t,r,"","",function(s){return e.call(n,s,o++)}),r}function uu(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Re={current:null},Gt={transition:null},lu={ReactCurrentDispatcher:Re,ReactCurrentBatchConfig:Gt,ReactCurrentOwner:Xn};ne.Children={map:Wt,forEach:function(t,e,n){Wt(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Wt(t,function(){e++}),e},toArray:function(t){return Wt(t,function(e){return e})||[]},only:function(t){if(!Qn(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ne.Component=gt;ne.Fragment=Qf;ne.Profiler=eu;ne.PureComponent=qn;ne.StrictMode=Zf;ne.Suspense=ou;ne.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=lu;ne.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=Xs({},t.props),o=t.key,s=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=Xn.current),e.key!==void 0&&(o=""+e.key),t.type&&t.type.defaultProps)var u=t.type.defaultProps;for(c in e)ei.call(e,c)&&!ti.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&u!==void 0?u[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){u=Array(c);for(var h=0;h<c;h++)u[h]=arguments[h+2];r.children=u}return{$$typeof:Tt,type:t.type,key:o,ref:s,props:r,_owner:a}};ne.createContext=function(t){return t={$$typeof:nu,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:tu,_context:t},t.Consumer=t};ne.createElement=ni;ne.createFactory=function(t){var e=ni.bind(null,t);return e.type=t,e};ne.createRef=function(){return{current:null}};ne.forwardRef=function(t){return{$$typeof:ru,render:t}};ne.isValidElement=Qn;ne.lazy=function(t){return{$$typeof:iu,_payload:{_status:-1,_result:t},_init:uu}};ne.memo=function(t,e){return{$$typeof:su,type:t,compare:e===void 0?null:e}};ne.startTransition=function(t){var e=Gt.transition;Gt.transition={};try{t()}finally{Gt.transition=e}};ne.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};ne.useCallback=function(t,e){return Re.current.useCallback(t,e)};ne.useContext=function(t){return Re.current.useContext(t)};ne.useDebugValue=function(){};ne.useDeferredValue=function(t){return Re.current.useDeferredValue(t)};ne.useEffect=function(t,e){return Re.current.useEffect(t,e)};ne.useId=function(){return Re.current.useId()};ne.useImperativeHandle=function(t,e,n){return Re.current.useImperativeHandle(t,e,n)};ne.useInsertionEffect=function(t,e){return Re.current.useInsertionEffect(t,e)};ne.useLayoutEffect=function(t,e){return Re.current.useLayoutEffect(t,e)};ne.useMemo=function(t,e){return Re.current.useMemo(t,e)};ne.useReducer=function(t,e,n){return Re.current.useReducer(t,e,n)};ne.useRef=function(t){return Re.current.useRef(t)};ne.useState=function(t){return Re.current.useState(t)};ne.useSyncExternalStore=function(t,e,n){return Re.current.useSyncExternalStore(t,e,n)};ne.useTransition=function(){return Re.current.useTransition()};ne.version="18.2.0";(function(t){t.exports=ne})(Gf);Be("pushpin:content-types");function du(t){const e=new URL(t),n=e.protocol,r=e.pathname;return{scheme:n?n.substr(0,n.length-1):"",id:(r||"//").substr(2)}}function hu(t){return du(t)}console.log("shared-worker starting up");Be.enable("DocSynchronizer");self.Automerge=hf;const gu="ws://67.207.88.83",Un=new Wf({storage:new Jf,network:[new qf(gu)],peerId:"shared-worker-"+Math.round(Math.random()*1e4),sharePolicy:t=>t.includes("storage-server")});self.addEventListener("connect",t=>{console.log("client connected to shared-worker");var e=t.ports[0];e.postMessage("READY"),e.onmessage=function(n){const r=n.data;"serviceWorkerPort"in r?_u(r.serviceWorkerPort):"repoNetworkPort"in r&&yu(r.repoNetworkPort)}});function _u(t){t.onmessage=e=>{const n=e.data,{binaryDataId:r}=n,{id:o}=hu(r);if(console.log(`[${o}]: shared-worker request`),!Un)throw new Error("REPO NOT SETUP YET");Un.find(o).value().then(a=>{console.log(`[${o}]: shared-worker value`,a);const{mimeType:u,binary:c}=a;var h=new ArrayBuffer(c.byteLength);new Uint8Array(h).set(new Uint8Array(c)),t.postMessage({binaryDataId:r,mimeType:u,binary:h},[h])})}}async function yu(t){Un.networkSubsystem.addNetworkAdapter(new Yf(t,{useWeakRef:!0}))}console.log("ran shared-worker to end")})();